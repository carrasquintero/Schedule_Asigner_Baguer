"""
Modelo de Optimización de Turnos usando OR-Tools
Optimiza la asignación de turnos para empleados de tiendas minimizando costos de nómina
"""
# ============================================================================
# IMPORTACIONES
# ============================================================================
from ortools.sat.python import cp_model
import pandas as pd
import math
from openpyxl import Workbook
from openpyxl.styles import PatternFill, Font, Alignment, Border, Side
# ============================================================================
# DEFINICIÓN DE PARÁMETROS
# ============================================================================
# Tiempo permitido para que un empleado pueda trabajar en dos tiendas
MAX_ALLOWED_OPTIMIZATION_TIME = 300

# Lista de tiendas a optimizar.
# Los elementos pueden ser una tienda individual (str) o un grupo (list).
STORES_TO_OPTIMIZE = ["835", ["380", "886"], ["818", "554"], "350", ["552", "838"], "670", "822", 
    "823", "829", "874", "880", "898", "520", "548", "660", "740", "820", "821", "831", "890",
    "150", "200", "550", "817", "827", "862", "897", "532", "546", "770", "881", "882", "846", "535", "536", "780", "781", "790",
    "830", "867", "866", "864", "870", "840", "865", "533", "894", "557", "551", "120", "140", "813", "815", "839", "842",
    "843", "825", "837", "871", "851", "869", "893"]

# Lista para almacenar tiendas que no encontraron solución
PENDING_STORES = []

# Constante para el nombre del empleado supernumerario
SUPERNUMERARY = "SUP"

# Parámetros para Sabatino (ahora por tienda)
SABATINO_WORKING_DAYS = {"545": ["Vie", "Sab", "Dom"], 
#"818": ["Vie", "Sab", "Dom"], 
    "824": ["Vie", "Sab", "Dom"],
    "420": ["Vie", "Sab", "Dom"], "817": ["Vie", "Sab", "Dom"], "862": ["Vie", "Sab", "Dom"], "546": ["Vie", "Sab", "Dom"],
    "770": ["Vie", "Sab", "Dom"], "881": ["Vie", "Sab", "Dom"], "846": ["Vie", "Sab", "Dom"], "866" : ["Vie", "Sab", "Dom"],
    "864": ["Vie", "Sab", "Dom"], "557": ["Vie", "Sab", "Dom"], "815": ["Vie", "Sab", "Dom"], "843": ["Vie", "Sab", "Dom"]}
SABATINO_MIN_HOURS = {"545": 8.0, 
#"818": 8.0, 
"824": 8.0, "420": 8.0, "817": 8.0, "862": 8.0, "546": 8.0, "770": 8.0, "881": 8.0, "846": 8.0, "866": 8.0, 
    "864": 8.0, "557": 8.0, "815": 8.0, "843": 8.0}
SABATINO_MAX_HOURS = {"545": 12.0, 
#"818": 12.0, 
"824": 12.0, "420": 12.0, "817": 12.0, "862": 12.0, "546": 12.0, "770": 12.0, "881": 12.0, "846": 12.0, 
    "866": 12.0, "864": 12.0, "557": 12.0, "815": 12.0, "843": 12.0}

# Determinar qué tiendas tienen Sabatino configurado (intersección de keys para asegurar configuración completa)
STORES_WITH_SABATINO = set(SABATINO_WORKING_DAYS.keys()) & set(SABATINO_MIN_HOURS.keys()) & set(SABATINO_MAX_HOURS.keys())

# Días de la semana
DAYS = ["Lun", "Mar", "Mie", "Jue", "Vie", "Sab", "Dom"]
# Horarios de apertura y cierre por tienda y día
# Ajusta los horarios específicos para cada tienda aquí
OPENING_HOURS = {
    "110": {"Lun": 9.0, "Mar": 9.0, "Mie": 9.0, "Jue": 9.0, "Vie": 9.0, "Sab": 9.0, "Dom": 9.5},
    "120": {"Lun": 9.0, "Mar": 9.0, "Mie": 9.0, "Jue": 9.0, "Vie": 9.0, "Sab": 9.0, "Dom": 10.0},
    "140": {"Lun": 9.0, "Mar": 9.0, "Mie": 9.0, "Jue": 9.0, "Vie": 9.0, "Sab": 9.0, "Dom": 9.5},
    "150": {"Lun": 9.0, "Mar": 9.0, "Mie": 9.0, "Jue": 9.0, "Vie": 9.0, "Sab": 9.0, "Dom": 10.0},
    "190": {"Lun": 9.0, "Mar": 9.0, "Mie": 9.0, "Jue": 9.0, "Vie": 9.0, "Sab": 9.0, "Dom": 9.5},
    "200": {"Lun": 9.0, "Mar": 9.0, "Mie": 9.0, "Jue": 9.0, "Vie": 9.0, "Sab": 9.0, "Dom": 9.5},
    "240": {"Lun": 8.0, "Mar": 8.0, "Mie": 8.0, "Jue": 8.0, "Vie": 8.5, "Sab": 8.5, "Dom": 10.0},
    "250": {"Lun": 8.0, "Mar": 8.0, "Mie": 8.0, "Jue": 8.0, "Vie": 8.5, "Sab": 8.5, "Dom": 10.0},
    "350": {"Lun": 8.0, "Mar": 8.0, "Mie": 8.0, "Jue": 8.0, "Vie": 8.0, "Sab": 8.0, "Dom": 8.5},
    "380": {"Lun": 9.0, "Mar": 9.0, "Mie": 9.0, "Jue": 9.0, "Vie": 9.0, "Sab": 9.0, "Dom": 9.5},
    "390": {"Lun": 9.0, "Mar": 9.0, "Mie": 9.0, "Jue": 9.0, "Vie": 9.0, "Sab": 9.0, "Dom": 9.5},
    "420": {"Lun": 9.5, "Mar": 9.5, "Mie": 9.5, "Jue": 9.5, "Vie": 9.5, "Sab": 9.0, "Dom": 9.5},
    "440": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 11.0},
    "460": {"Lun": 8.0, "Mar": 8.0, "Mie": 8.0, "Jue": 8.0, "Vie": 8.5, "Sab": 8.5, "Dom": 10.0},
    "490": {"Lun": 9.0, "Mar": 9.0, "Mie": 9.0, "Jue": 9.0, "Vie": 9.0, "Sab": 9.0, "Dom": 9.5},
    "510": {"Lun": 9.0, "Mar": 9.0, "Mie": 9.0, "Jue": 9.0, "Vie": 9.0, "Sab": 9.0, "Dom": 11.0},
    "520": {"Lun": 8.5, "Mar": 8.5, "Mie": 8.5, "Jue": 8.5, "Vie": 8.5, "Sab": 8.5, "Dom": 8.5},
    "524": {"Lun": 9.5, "Mar": 9.5, "Mie": 9.5, "Jue": 9.5, "Vie": 9.5, "Sab": 9.5, "Dom": 10.0},
    "530": {"Lun": 8.0, "Mar": 8.0, "Mie": 8.0, "Jue": 8.0, "Vie": 8.5, "Sab": 8.5, "Dom": 10.0},
    "532": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 10.0},
    "533": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 10.0},
    "534": {"Lun": 9.5, "Mar": 9.5, "Mie": 9.5, "Jue": 9.5, "Vie": 9.5, "Sab": 9.5, "Dom": 10.0},
    "535": {"Lun": 9.0, "Mar": 9.0, "Mie": 9.0, "Jue": 9.0, "Vie": 9.0, "Sab": 9.0, "Dom": 9.0},
    "536": {"Lun": 9.0, "Mar": 9.0, "Mie": 9.0, "Jue": 9.0, "Vie": 9.0, "Sab": 9.0, "Dom": 9.0},
    "539": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 10.0},
    "540": {"Lun": 9.5, "Mar": 9.5, "Mie": 9.5, "Jue": 9.5, "Vie": 9.5, "Sab": 9.0, "Dom": 9.5},
    "541": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 10.0},
    "545": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 10.0},
    "546": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 10.0},
    "548": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 10.0},
    "550": {"Lun": 9.0, "Mar": 9.0, "Mie": 9.0, "Jue": 9.0, "Vie": 9.0, "Sab": 9.0, "Dom": 9.5},
    "551": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 10.0},
    "552": {"Lun": 5.0, "Mar": 5.0, "Mie": 5.0, "Jue": 5.0, "Vie": 5.0, "Sab": 5.0, "Dom": 5.0},
    "554": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 9.5, "Dom": 10.0},
    "557": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 10.0},
    "620": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 11.0},
    "621": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 11.0},
    "630": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 10.0},
    "640": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 11.0},
    "660": {"Lun": 8.5, "Mar": 8.5, "Mie": 8.5, "Jue": 8.5, "Vie": 8.5, "Sab": 8.5, "Dom": 8.5},
    "670": {"Lun": 8.0, "Mar": 8.0, "Mie": 8.0, "Jue": 8.0, "Vie": 8.0, "Sab": 8.0, "Dom": 8.5},
    "740": {"Lun": 8.5, "Mar": 8.5, "Mie": 8.5, "Jue": 8.5, "Vie": 8.5, "Sab": 8.5, "Dom": 10.0},
    "770": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 10.0},
    "780": {"Lun": 9.0, "Mar": 9.0, "Mie": 9.0, "Jue": 9.0, "Vie": 9.0, "Sab": 9.0, "Dom": 10.0},
    "781": {"Lun": 9.0, "Mar": 9.0, "Mie": 9.0, "Jue": 9.0, "Vie": 9.0, "Sab": 9.0, "Dom": 10.0},
    "790": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 11.0},
    "810": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 10.0},
    "813": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 9.5, "Dom": 10.0},
    "815": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 9.5, "Dom": 10.0},
    "817": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 9.5, "Dom": 10.0},
    "818": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 9.5, "Dom": 10.0},
    "819": {"Lun": 8.5, "Mar": 8.5, "Mie": 8.5, "Jue": 8.5, "Vie": 8.5, "Sab": 8.5, "Dom": 9.0},
    "820": {"Lun": 8.5, "Mar": 8.5, "Mie": 8.5, "Jue": 8.5, "Vie": 8.5, "Sab": 8.5, "Dom": 10.0},
    "821": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 10.0},
    "822": {"Lun": 8.0, "Mar": 8.0, "Mie": 8.0, "Jue": 8.0, "Vie": 8.0, "Sab": 8.0, "Dom": 8.5},
    "823": {"Lun": 8.0, "Mar": 8.0, "Mie": 8.0, "Jue": 8.0, "Vie": 8.0, "Sab": 8.0, "Dom": 8.5},
    "824": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 10.0},
    "825": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 10.0},
    "826": {"Lun": 9.5, "Mar": 9.5, "Mie": 9.5, "Jue": 9.5, "Vie": 9.5, "Sab": 9.0, "Dom": 9.5},
    "827": {"Lun": 9.5, "Mar": 9.5, "Mie": 9.5, "Jue": 9.5, "Vie": 9.5, "Sab": 9.0, "Dom": 9.5},
    "828": {"Lun": 8.5, "Mar": 8.5, "Mie": 8.5, "Jue": 8.5, "Vie": 8.5, "Sab": 8.5, "Dom": 9.0},
    "829": {"Lun": 9.5, "Mar": 9.5, "Mie": 9.5, "Jue": 9.5, "Vie": 9.5, "Sab": 9.0, "Dom": 9.5},
    "830": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 11.0},
    "831": {"Lun": 8.0, "Mar": 8.0, "Mie": 8.0, "Jue": 8.0, "Vie": 8.0, "Sab": 8.0, "Dom": 8.5},
    "833": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 10.0},
    "835": {"Lun": 9.5, "Mar": 9.5, "Mie": 9.5, "Jue": 9.5, "Vie": 9.5, "Sab": 9.5, "Dom": 10.0},
    "836": {"Lun": 9.5, "Mar": 9.5, "Mie": 9.5, "Jue": 9.5, "Vie": 9.5, "Sab": 9.0, "Dom": 9.5},
    "837": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 10.0},
    "838": {"Lun": 5.0, "Mar": 5.0, "Mie": 5.0, "Jue": 5.0, "Vie": 5.0, "Sab": 5.0, "Dom": 5.0},
    "839": {"Lun": 8.5, "Mar": 8.5, "Mie": 8.5, "Jue": 8.5, "Vie": 8.5, "Sab": 8.5, "Dom": 9.0},
    "840": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 11.0},
    "841": {"Lun": 8.0, "Mar": 8.0, "Mie": 8.0, "Jue": 8.0, "Vie": 8.0, "Sab": 8.0},
    "842": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 9.5, "Dom": 10.0},
    "843": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 9.5, "Dom": 10.0},
    "844": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 10.0},
    "845": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 10.0},
    "846": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 10.0},
    "847": {"Lun": 8.5, "Mar": 8.5, "Mie": 8.5, "Jue": 8.5, "Vie": 8.5, "Sab": 8.5, "Dom": 9.0},
    "851": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 10.0},
    "852": {"Lun": 9.5, "Mar": 9.5, "Mie": 9.5, "Jue": 9.5, "Vie": 9.5, "Sab": 9.0, "Dom": 9.5},
    "856": {"Lun": 9.0, "Mar": 9.0, "Mie": 9.0, "Jue": 9.0, "Vie": 9.0, "Sab": 9.0, "Dom": 9.5},
    "858": {"Lun": 9.5, "Mar": 9.5, "Mie": 9.5, "Jue": 9.5, "Vie": 9.5, "Sab": 9.5, "Dom": 10.0},
    "859": {"Lun": 8.0, "Mar": 8.0, "Mie": 8.0, "Jue": 8.0, "Vie": 8.5, "Sab": 8.5, "Dom": 10.0},
    "861": {"Lun": 9.5, "Mar": 9.5, "Mie": 9.5, "Jue": 9.5, "Vie": 9.5, "Sab": 9.5, "Dom": 10.0},
    "862": {"Lun": 9.0, "Mar": 9.0, "Mie": 9.0, "Jue": 9.0, "Vie": 9.0, "Sab": 9.5, "Dom": 10.0},
    "863": {"Lun": 9.0, "Mar": 9.0, "Mie": 9.0, "Jue": 9.0, "Vie": 9.0, "Sab": 9.0, "Dom": 9.5},
    "864": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 10.0},
    "865": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 11.0},
    "866": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 10.0},
    "867": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 11.0},
    "868": {"Lun": 8.5, "Mar": 8.5, "Mie": 8.5, "Jue": 8.5, "Vie": 8.5, "Sab": 8.5, "Dom": 9.0},
    "869": {"Lun": 8.0, "Mar": 8.0, "Mie": 8.0, "Jue": 8.0, "Vie": 8.0, "Sab": 8.0, "Dom": 9.0},
    "870": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 11.0},
    "871": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 10.0},
    "872": {"Lun": 9.0, "Mar": 9.0, "Mie": 9.0, "Jue": 9.0, "Vie": 9.0, "Sab": 9.0, "Dom": 9.0},
    "873": {"Lun": 9.0, "Mar": 9.0, "Mie": 9.0, "Jue": 9.0, "Vie": 9.0, "Sab": 9.0, "Dom": 9.0},
    "874": {"Lun": 8.0, "Mar": 8.0, "Mie": 8.0, "Jue": 8.0, "Vie": 8.0, "Sab": 8.0, "Dom": 8.5},
    "876": {"Lun": 9.0, "Mar": 9.0, "Mie": 9.0, "Jue": 9.0, "Vie": 9.0, "Sab": 9.0, "Dom": 9.0},
    "877": {"Lun": 9.0, "Mar": 9.0, "Mie": 9.0, "Jue": 9.0, "Vie": 9.0, "Sab": 9.0, "Dom": 9.0},
    "878": {"Lun": 9.0, "Mar": 9.0, "Mie": 9.0, "Jue": 9.0, "Vie": 9.0, "Sab": 9.0, "Dom": 9.0},
    "879": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 10.0},
    "880": {"Lun": 9.5, "Mar": 9.5, "Mie": 9.5, "Jue": 9.5, "Vie": 9.5, "Sab": 9.0, "Dom": 9.5},
    "881": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 10.0},
    "882": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 10.0},
    "883": {"Lun": 9.0, "Mar": 9.0, "Mie": 9.0, "Jue": 9.0, "Vie": 9.0, "Sab": 9.0, "Dom": 10.0},
    "884": {"Lun": 9.5, "Mar": 9.5, "Mie": 9.5, "Jue": 9.5, "Vie": 9.5, "Sab": 9.5, "Dom": 10.0},
    "885": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 11.0},
    "886": {"Lun": 9.0, "Mar": 9.0, "Mie": 9.0, "Jue": 9.0, "Vie": 9.0, "Sab": 9.0, "Dom": 9.5},
    "887": {"Lun": 9.0, "Mar": 9.0, "Mie": 9.0, "Jue": 9.0, "Vie": 9.0, "Sab": 9.0, "Dom": 9.0},
    "888": {"Lun": 9.0, "Mar": 9.0, "Mie": 9.0, "Jue": 9.0, "Vie": 9.0, "Sab": 9.0, "Dom": 9.0},
    "889": {"Lun": 9.0, "Mar": 9.0, "Mie": 9.0, "Jue": 9.0, "Vie": 9.0, "Sab": 9.0, "Dom": 9.0},
    "890": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 10.0},
    "891": {"Lun": 9.0, "Mar": 9.0, "Mie": 9.0, "Jue": 9.0, "Vie": 9.0, "Sab": 9.0, "Dom": 9.0},
    "892": {"Lun": 9.0, "Mar": 9.0, "Mie": 9.0, "Jue": 9.0, "Vie": 9.0, "Sab": 9.0, "Dom": 9.0},
    "893": {"Lun": 8.0, "Mar": 8.0, "Mie": 8.0, "Jue": 8.0, "Vie": 8.0, "Sab": 8.0, "Dom": 8.5},
    "894": {"Lun": 10.0, "Mar": 10.0, "Mie": 10.0, "Jue": 10.0, "Vie": 10.0, "Sab": 10.0, "Dom": 10.0},
    "895": {"Lun": 8.0, "Mar": 8.0, "Mie": 8.0, "Jue": 8.0, "Vie": 8.5, "Sab": 8.5, "Dom": 10.0},
    "897": {"Lun": 8.5, "Mar": 8.5, "Mie": 8.5, "Jue": 8.5, "Vie": 8.5, "Sab": 8.5, "Dom": 9.0},
    "898": {"Lun": 9.5, "Mar": 9.5, "Mie": 9.5, "Jue": 9.5, "Vie": 9.5, "Sab": 9.0, "Dom": 9.5},
}
CLOSING_HOURS = {
    "110": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 20.5, "Sab": 20.5, "Dom": 17.0},
    "120": {"Lun": 20.0, "Mar": 20.0, "Mie": 20.0, "Jue": 20.0, "Vie": 20.0, "Sab": 20.0, "Dom": 19.0},
    "140": {"Lun": 20.0, "Mar": 20.0, "Mie": 20.0, "Jue": 20.0, "Vie": 20.0, "Sab": 20.0, "Dom": 19.0},
    "150": {"Lun": 20.0, "Mar": 20.0, "Mie": 20.0, "Jue": 20.0, "Vie": 20.0, "Sab": 20.0, "Dom": 19.0},
    "190": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 21.0, "Sab": 21.0, "Dom": 20.5},
    "200": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 20.5, "Sab": 20.5, "Dom": 20.5},
    "240": {"Lun": 19.5, "Mar": 19.5, "Mie": 19.5, "Jue": 19.5, "Vie": 20.0, "Sab": 20.0, "Dom": 18.0},
    "250": {"Lun": 19.5, "Mar": 19.5, "Mie": 19.5, "Jue": 19.5, "Vie": 20.0, "Sab": 20.0, "Dom": 18.0},
    "350": {"Lun": 19.5, "Mar": 19.5, "Mie": 19.5, "Jue": 19.5, "Vie": 20.0, "Sab": 20.0, "Dom": 14.0},
    "380": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 21.0, "Sab": 21.0, "Dom": 20.5},
    "390": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 21.0, "Sab": 21.0, "Dom": 20.5},
    "420": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 21.0, "Sab": 21.0, "Dom": 20.5},
    "440": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 21.0, "Sab": 21.0, "Dom": 19.5},
    "460": {"Lun": 19.5, "Mar": 19.5, "Mie": 19.5, "Jue": 19.5, "Vie": 20.0, "Sab": 20.0, "Dom": 18.0},
    "490": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 21.0, "Sab": 21.0, "Dom": 20.5},
    "510": {"Lun": 20.0, "Mar": 20.0, "Mie": 20.0, "Jue": 20.0, "Vie": 20.0, "Sab": 20.0, "Dom": 18.0},
    "520": {"Lun": 20.0, "Mar": 20.0, "Mie": 20.0, "Jue": 20.0, "Vie": 20.0, "Sab": 21.0, "Dom": 17.5},
    "524": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "530": {"Lun": 19.5, "Mar": 19.5, "Mie": 19.5, "Jue": 19.5, "Vie": 20.0, "Sab": 20.0, "Dom": 18.0},
    "532": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "533": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "534": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 21.0, "Sab": 21.0, "Dom": 20.5},
    "535": {"Lun": 20.0, "Mar": 20.0, "Mie": 20.0, "Jue": 20.0, "Vie": 20.0, "Sab": 20.0, "Dom": 19.0},
    "536": {"Lun": 20.0, "Mar": 20.0, "Mie": 20.0, "Jue": 20.0, "Vie": 20.0, "Sab": 20.0, "Dom": 19.0},
    "539": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.5, "Sab": 21.5, "Dom": 20.0},
    "540": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 21.0, "Sab": 21.0, "Dom": 20.5},
    "541": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.5, "Sab": 21.5, "Dom": 20.0},
    "545": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "546": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "548": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.5, "Sab": 21.5, "Dom": 20.5},
    "550": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 20.5, "Sab": 21.0, "Dom": 20.5},
    "551": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "552": {"Lun": 22.0, "Mar": 22.0, "Mie": 22.0, "Jue": 22.0, "Vie": 22.0, "Sab": 22.0, "Dom": 22.0},
    "554": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 21.0, "Sab": 21.0, "Dom": 20.5},
    "557": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "620": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 21.0, "Sab": 21.0, "Dom": 19.5},
    "621": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 21.0, "Sab": 21.0, "Dom": 19.5},
    "630": {"Lun": 20.0, "Mar": 20.0, "Mie": 20.0, "Jue": 20.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "640": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 21.0, "Sab": 21.0, "Dom": 19.5},
    "660": {"Lun": 20.0, "Mar": 20.0, "Mie": 20.0, "Jue": 20.0, "Vie": 20.0, "Sab": 21.0, "Dom": 17.5},
    "670": {"Lun": 19.5, "Mar": 19.5, "Mie": 19.5, "Jue": 19.5, "Vie": 20.0, "Sab": 20.0, "Dom": 14.0},
    "740": {"Lun": 20.0, "Mar": 20.0, "Mie": 20.0, "Jue": 20.0, "Vie": 20.0, "Sab": 20.5, "Dom": 14.0},
    "770": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "780": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "781": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "790": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "810": {"Lun": 20.0, "Mar": 20.0, "Mie": 20.0, "Jue": 20.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "813": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.5, "Sab": 21.5, "Dom": 20.5},
    "815": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.5, "Sab": 21.5, "Dom": 20.5},
    "817": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 20.5, "Sab": 21.0, "Dom": 20.5},
    "818": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 21.0, "Sab": 21.0, "Dom": 20.5},
    "819": {"Lun": 19.5, "Mar": 19.5, "Mie": 19.5, "Jue": 19.5, "Vie": 20.0, "Sab": 20.0, "Dom": 18.0},
    "820": {"Lun": 20.0, "Mar": 20.0, "Mie": 20.0, "Jue": 20.0, "Vie": 20.0, "Sab": 20.5, "Dom": 14.0},
    "821": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.5, "Sab": 21.5, "Dom": 20.5},
    "822": {"Lun": 19.5, "Mar": 19.5, "Mie": 19.5, "Jue": 19.5, "Vie": 20.0, "Sab": 20.0, "Dom": 14.0},
    "823": {"Lun": 19.5, "Mar": 19.5, "Mie": 19.5, "Jue": 19.5, "Vie": 20.0, "Sab": 20.0, "Dom": 14.0},
    "824": {"Lun": 20.0, "Mar": 20.0, "Mie": 20.0, "Jue": 20.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "825": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "826": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 20.5, "Sab": 21.0, "Dom": 20.5},
    "827": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 20.5, "Sab": 21.0, "Dom": 20.5},
    "828": {"Lun": 19.5, "Mar": 19.5, "Mie": 19.5, "Jue": 19.5, "Vie": 20.0, "Sab": 20.0, "Dom": 18.0},
    "829": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 21.0, "Sab": 21.0, "Dom": 20.5},
    "830": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "831": {"Lun": 19.5, "Mar": 19.5, "Mie": 19.5, "Jue": 19.5, "Vie": 20.0, "Sab": 20.0, "Dom": 17.5},
    "833": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 21.5, "Sab": 21.5, "Dom": 20.5},
    "835": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "836": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 20.5, "Sab": 21.0, "Dom": 20.5},
    "837": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "838": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.0, "Dom": 21.0},
    "839": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 20.5, "Sab": 20.5, "Dom": 17.5},
    "840": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "841": {"Lun": 19.0, "Mar": 19.0, "Mie": 19.0, "Jue": 19.0, "Vie": 19.0, "Sab": 19.0},
    "842": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.5, "Dom": 20.5},
    "843": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.5, "Dom": 20.5},
    "844": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 21.5, "Sab": 21.5, "Dom": 20},
    "845": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 21.5, "Sab": 21.5, "Dom": 20},
    "846": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20},
    "847": {"Lun": 19.5, "Mar": 19.5, "Mie": 19.5, "Jue": 19.5, "Vie": 20.0, "Sab": 20.0, "Dom": 18.0},
    "851": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "852": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 20.5, "Sab": 21.0, "Dom": 20.5},
    "856": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 21.0, "Sab": 21.0, "Dom": 20.5},
    "858": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "859": {"Lun": 19.5, "Mar": 19.5, "Mie": 19.5, "Jue": 19.5, "Vie": 20.0, "Sab": 20.0, "Dom": 18.0},
    "861": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "862": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.5, "Dom": 20.5},
    "863": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 20.5, "Sab": 20.5, "Dom": 17.5},
    "864": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "865": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "866": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "867": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "868": {"Lun": 19.5, "Mar": 19.5, "Mie": 19.5, "Jue": 19.5, "Vie": 20.0, "Sab": 20.0, "Dom": 17.5},
    "869": {"Lun": 20.0, "Mar": 20.0, "Mie": 20.0, "Jue": 20.0, "Vie": 20.0, "Sab": 20.0, "Dom": 18.0},
    "870": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "871": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "872": {"Lun": 20.0, "Mar": 20.0, "Mie": 20.0, "Jue": 20.0, "Vie": 20.0, "Sab": 20.0, "Dom": 18.0},
    "873": {"Lun": 20.0, "Mar": 20.0, "Mie": 20.0, "Jue": 20.0, "Vie": 20.0, "Sab": 20.0, "Dom": 18.0},
    "874": {"Lun": 19.5, "Mar": 19.5, "Mie": 19.5, "Jue": 19.5, "Vie": 20.0, "Sab": 20.0, "Dom": 14.0},
    "876": {"Lun": 20.0, "Mar": 20.0, "Mie": 20.0, "Jue": 20.0, "Vie": 20.0, "Sab": 20.0, "Dom": 18.0},
    "877": {"Lun": 20.0, "Mar": 20.0, "Mie": 20.0, "Jue": 20.0, "Vie": 20.0, "Sab": 20.0, "Dom": 18.0},
    "878": {"Lun": 20.0, "Mar": 20.0, "Mie": 20.0, "Jue": 20.0, "Vie": 20.0, "Sab": 20.0, "Dom": 18.0},
    "879": {"Lun": 20.0, "Mar": 20.0, "Mie": 20.0, "Jue": 20.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "880": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 21.0, "Sab": 21.0, "Dom": 20.5},
    "881": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "882": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "883": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "884": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "885": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 21.0, "Sab": 21.0, "Dom": 19.5},
    "886": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 21.0, "Sab": 21.0, "Dom": 20.5},
    "887": {"Lun": 20.0, "Mar": 20.0, "Mie": 20.0, "Jue": 20.0, "Vie": 20.0, "Sab": 20.0, "Dom": 18.0},
    "888": {"Lun": 20.0, "Mar": 20.0, "Mie": 20.0, "Jue": 20.0, "Vie": 20.0, "Sab": 20.0, "Dom": 18.0},
    "889": {"Lun": 20.0, "Mar": 20.0, "Mie": 20.0, "Jue": 20.0, "Vie": 20.0, "Sab": 20.0, "Dom": 18.0},
    "890": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.5, "Dom": 20.5},
    "891": {"Lun": 20.0, "Mar": 20.0, "Mie": 20.0, "Jue": 20.0, "Vie": 20.0, "Sab": 20.0, "Dom": 19.0},
    "892": {"Lun": 20.0, "Mar": 20.0, "Mie": 20.0, "Jue": 20.0, "Vie": 20.0, "Sab": 20.0, "Dom": 19.0},
    "893": {"Lun": 19.5, "Mar": 19.5, "Mie": 19.5, "Jue": 19.5, "Vie": 20.0, "Sab": 20.0, "Dom": 17.5},
    "894": {"Lun": 21.0, "Mar": 21.0, "Mie": 21.0, "Jue": 21.0, "Vie": 21.0, "Sab": 21.0, "Dom": 20.0},
    "895": {"Lun": 19.5, "Mar": 19.5, "Mie": 19.5, "Jue": 19.5, "Vie": 20.0, "Sab": 20.0, "Dom": 18.0},
    "897": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 20.5, "Sab": 20.5, "Dom": 17.5},
    "898": {"Lun": 20.5, "Mar": 20.5, "Mie": 20.5, "Jue": 20.5, "Vie": 21.0, "Sab": 21.0, "Dom": 20.5},
}

# Número de empleados por tienda
EMPLOYEES_PER_STORE = {
    "110": 3,
    "120": 4,
    "140": 3,
    "150": 4,
    "190": 4,
    "200": 4,
    "240": 4,
    "250": 3,
    "350": 4,
    "380": 3,
    "390": 4,
    "420": 6,
    "440": 5,
    "460": 3,
    "490": 4,
    "510": 3,
    "520": 5,
    "524": 4,
    "530": 3,
    "532": 4,
    "533": 4,
    "534": 4,
    "535": 7,
    "536": 7,
    "539": 4,
    "540": 3,
    "541": 6,
    "545": 3,
    "546": 5,
    "548": 3,
    "550": 3,
    "551": 3,
    "552": 2,
    "554": 1,
    "557": 3,
    "620": 4,
    "621": 4,
    "630": 3,
    "640": 3,
    "660": 3,
    "670": 7,
    "740": 3,
    "770": 4,
    "780": 4,
    "781": 4,
    "790": 4,
    "810": 4,
    "813": 4,
    "815": 5,
    "817": 4,
    "818": 6,
    "819": 4,
    "820": 3,
    "821": 4,
    "822": 5,
    "823": 6,
    "824": 4,
    "825": 6,
    "826": 4,
    "827": 4,
    "828": 5,
    "829": 3,
    "830": 4,
    "831": 4,
    "833": 3,
    "835": 6,
    "836": 4,
    "837": 4,
    "838": 2,
    "839": 5,
    "840": 4,
    "841": 3,
    "842": 4,
    "843": 5,
    "844": 5,
    "845": 4,
    "846": 3,
    "847": 5,
    "851": 4,
    "852": 4,
    "856": 4,
    "858": 5,
    "859": 4,
    "861": 4,
    "862": 7,
    "863": 3,
    "864": 4,
    "865": 4,
    "866": 4,
    "867": 4,
    "868": 6,
    "869": 5,
    "870": 4,
    "871": 4,
    "872": 4,
    "873": 4,
    "874": 5,
    "876": 3,
    "877": 4,
    "878": 3,
    "879": 3,
    "880": 3,
    "881": 3,
    "882": 4,
    "883": 4,
    "884": 6,
    "885": 3,
    "886": 3,
    "887": 4,
    "888": 4,
    "889": 4,
    "890": 3,
    "891": 4,
    "892": 3,
    "893": 4,
    "894": 4,
    "895": 4,
    "897": 4,
    "898": 3,
}
# Límite máximo de empleados deseados en la hora de mayor afluencia (hora pico)
# El cálculo de personal_requerido NUNCA superará este valor por tienda
MIN_EMPLOYEES_PEAK_HOUR = {
    "110": 3,
    "120": 4,
    "140": 3,
    "150": 4,
    "190": 4,
    "200": 4,
    "240": 4,
    "250": 3,
    "350": 4,
    "380": 3,
    "390": 4,
    "420": 6,
    "440": 5,
    "460": 3,
    "490": 4,
    "510": 3,
    "520": 5,
    "524": 4,
    "530": 3,
    "532": 4,
    "533": 4,
    "534": 4,
    "535": 7,
    "536": 7,
    "539": 4,
    "540": 3,
    "541": 6,
    "545": 3,
    "546": 5,
    "548": 3,
    "550": 3,
    "551": 3,
    "552": 2,
    "554": 1,
    "557": 3,
    "620": 4,
    "621": 4,
    "630": 3,
    "640": 3,
    "660": 3,
    "670": 7,
    "740": 3,
    "770": 4,
    "780": 4,
    "781": 4,
    "790": 4,
    "810": 4,
    "813": 4,
    "815": 5,
    "817": 4,
    "818": 6,
    "819": 4,
    "820": 3,
    "821": 4,
    "822": 5,
    "823": 6,
    "824": 5,
    "825": 6,
    "826": 4,
    "827": 4,
    "828": 5,
    "829": 3,
    "830": 4,
    "831": 4,
    "833": 3,
    "835": 6,
    "836": 4,
    "837": 4,
    "838": 2,
    "839": 5,
    "840": 4,
    "841": 3,
    "842": 4,
    "843": 5,
    "844": 5,
    "845": 4,
    "846": 3,
    "847": 5,
    "851": 4,
    "852": 4,
    "856": 4,
    "858": 5,
    "859": 4,
    "861": 4,
    "862": 7,
    "863": 3,
    "864": 4,
    "865": 4,
    "866": 4,
    "867": 4,
    "868": 6,
    "869": 5,
    "870": 4,
    "871": 4,
    "872": 4,
    "873": 4,
    "874": 5,
    "876": 3,
    "877": 4,
    "878": 3,
    "879": 3,
    "880": 3,
    "881": 3,
    "882": 4,
    "883": 4,
    "884": 6,
    "885": 3,
    "886": 3,
    "887": 4,
    "888": 4,
    "889": 4,
    "890": 3,
    "891": 4,
    "892": 3,
    "893": 4,
    "894": 4,
    "895": 4,
    "897": 4,
    "898": 3,
}

# Días permitidos de descanso por tienda y para el supernumerario
ALLOWED_REST_DAYS = {
    "Supernumerario": ["Lun", "Mar", "Mie", "Dom"],
    "110": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "120": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "140": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "150": ["Lun", "Mar", "Dom"],
    "190": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "200": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "240": ["Lun", "Mar", "Mie", "Dom"],
    "250": ["Lun", "Mar", "Mie", "Dom"],
    "350": ["Lun", "Mar", "Mie", "Dom"],
    "380": ["Lun", "Mar", "Mie", "Jue", "Vie", "Dom"],
    "390": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "420": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "440": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "460": ["Lun", "Mar", "Dom"],
    "490": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "510": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "520": ["Lun", "Mar", "Mie", "Dom"],
    "524": ["Lun", "Mar", "Mie", "Dom"],
    "530": ["Lun", "Mar", "Dom"],
    "532": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "533": ["Lun", "Mar", "Mie", "Dom"],
    "534": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "535": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "536": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "539": ["Lun", "Mar", "Mie", "Dom"],
    "540": ["Lun", "Mar", "Mie", "Dom"],
    "541": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "545": ["Lun", "Mar", "Mie", "Dom"],
    "546": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "548": ["Lun", "Mar", "Mie", "Dom"],
    "550": ["Lun", "Mar", "Mie", "Dom"],
    "551": ["Lun", "Mar", "Dom"],
    "552": ["Lun", "Mar", "Mie", "Jue", "Vie", "Sab", "Dom"],
    "554": ["Lun", "Mar", "Mie", "Dom"],
    "557": ["Lun", "Mar", "Dom"],
    "620": ["Lun", "Mar", "Mie", "Dom"],
    "621": ["Lun", "Mar", "Mie", "Dom"],
    "630": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "640": ["Lun", "Mar", "Dom"],
    "660": ["Lun", "Mar", "Mie", "Dom"],
    "670": ["Lun", "Mar", "Mie", "Dom"],
    "740": ["Lun", "Mar", "Mie", "Dom"],
    "770": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "780": ["Lun", "Mar", "Mie", "Dom"],
    "781": ["Lun", "Mar", "Mie", "Dom"],
    "790": ["Lun", "Mar", "Mie", "Dom"],
    "810": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "813": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "815": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "817": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "818": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "819": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "820": ["Lun", "Mar", "Mie", "Dom"],
    "821": ["Lun", "Mar", "Mie", "Dom"],
    "822": ["Lun", "Mar", "Mie", "Dom"],
    "823": ["Lun", "Mar", "Mie", "Dom"],
    "824": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "825": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "826": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "827": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "828": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "829": ["Lun", "Mar", "Mie", "Dom"],
    "830": ["Lun", "Mar", "Mie", "Dom"],
    "831": ["Lun", "Mar", "Mie", "Dom"],
    "833": ["Lun", "Mar", "Mie", "Dom"],
    "835": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "836": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "837": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "838": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "839": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "840": ["Lun", "Mar", "Mie", "Dom"],
    "841": ["Dom"],
    "842": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "843": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "844": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "845": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "846": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "847": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "851": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "852": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "856": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "858": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "859": ["Lun", "Mar", "Mie", "Dom"],
    "861": ["Lun", "Mar", "Mie", "Dom"],
    "862": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "863": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "864": ["Lun", "Mar", "Mie", "Dom"],
    "865": ["Lun", "Mar", "Mie", "Dom"],
    "866": ["Lun", "Mar", "Mie", "Dom"],
    "867": ["Lun", "Mar", "Mie", "Dom"],
    "868": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "869": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "870": ["Lun", "Mar", "Mie", "Dom"],
    "871": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "872": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "873": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "874": ["Lun", "Mar", "Mie", "Dom"],
    "876": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "877": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "878": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "879": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "880": ["Lun", "Mar", "Mie", "Dom"],
    "881": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "882": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "883": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "884": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "885": ["Lun", "Mar", "Dom"],
    "886": ["Lun", "Mar", "Mie", "Jue", "Vie", "Dom"],
    "887": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "888": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "889": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "890": ["Lun", "Mar", "Mie", "Dom"],
    "891": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "892": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "893": ["Lun", "Mar", "Mie", "Dom"],
    "894": ["Lun", "Mar", "Mie", "Dom"],
    "895": ["Lun", "Mar", "Mie", "Dom"],
    "897": ["Lun", "Mar", "Mie", "Jue", "Dom"],
    "898": ["Lun", "Mar", "Mie", "Dom"]

}

MIN_EMPLOYEES_ALL_TIMES = {
    "110": 1,
    "120": 2,
    "140": 2,
    "150": 2,
    "190": 2,
    "200": 2,
    "240": 1,
    "250": 1,
    "350": 1,
    "380": 2,
    "390": 2,
    "420": 2,
    "440": 2,
    "460": 1,
    "490": 2,
    "510": 1,
    "520": 2,
    "524": 2,
    "530": 1,
    "532": 2,
    "533": 2,
    "534": 2,
    "535": 2,
    "536": 2,
    "539": 2,
    "540": 1,
    "541": 2,
    "545": 1,
    "546": 2,
    "548": 1,
    "550": 1,
    "551": 1,
    "552": 1,
    "554": 1,
    "557": 1,
    "620": 2,
    "621": 2,
    "630": 1,
    "640": 1,
    "660": 1,
    "670": 2,
    "740": 1,
    "770": 2,
    "780": 1,
    "781": 1,
    "790": 1,
    "810": 2,
    "813": 2,
    "815": 2,
    "817": 1,
    "818": 2,
    "819": 2,
    "820": 1,
    "821": 2,
    "822": 2,
    "823": 2,
    "824": 2,
    "825": 2,
    "826": 2,
    "827": 2,
    "828": 2,
    "829": 1,
    "830": 1,
    "831": 1,
    "833": 1,
    "835": 3,
    "836": 2,
    "837": 1,
    "838": 1,
    "839": 2,
    "840": 1,
    "841": 1,
    "842": 2,
    "843": 2,
    "844": 2,
    "845": 2,
    "846": 1,
    "847": 2,
    "851": 2,
    "852": 2,
    "856": 2,
    "858": 2,
    "859": 2,
    "861": 1,
    "862": 2,
    "863": 1,
    "864": 2,
    "865": 1,
    "866": 2,
    "867": 1,
    "868": 3,
    "869": 2,
    "870": 1,
    "871": 2,
    "872": 2,
    "873": 2,
    "874": 2,
    "876": 1,
    "877": 2,
    "878": 1,
    "879": 1,
    "880": 1,
    "881": 1,
    "882": 1,
    "883": 2,
    "884": 2,
    "885": 1,
    "886": 2,
    "887": 2,
    "888": 2,
    "889": 2,
    "890": 1,
    "891": 2,
    "892": 1,
    "893": 2,
    "894": 2,
    "895": 2,
    "897": 2,
    "898": 1
}
# Diccionario para overrides de personal mínimo requerido
# Clave: (tienda, día, hora), Valor: personal mínimo
# Ejemplo: {("110", "Lun", 9.0): 2, ("863", "Mar", 10.5): 3}
MIN_STAFF_OVERRIDE = {
    ("110", "Lun", 9.0): 1,	("110", "Mar", 9.0): 1,	("110", "Mie", 9.0): 1,	("110", "Jue", 9.0): 1,	("110", "Vie", 9.0): 1,	("110", "Sab", 9.0): 1,	("110", "Dom", 9.5): 1,
    ("120", "Lun", 9.0): 2,	("120", "Mar", 9.0): 2,	("120", "Mie", 9.0): 2,	("120", "Jue", 9.0): 2,	("120", "Vie", 9.0): 2,	("120", "Sab", 9.0): 2,	("120", "Dom", 10.0): 2,
    ("140", "Lun", 9.0): 1,	("140", "Mar", 9.0): 1,	("140", "Mie", 9.0): 1,	("140", "Jue", 9.0): 1,	("140", "Vie", 9.0): 1,	("140", "Sab", 9.0): 1,	("140", "Dom", 9.5): 1,
    ("150", "Lun", 9.0): 2,	("150", "Mar", 9.0): 2,	("150", "Mie", 9.0): 2,	("150", "Jue", 9.0): 2,	("150", "Vie", 9.0): 2,	("150", "Sab", 9.0): 2,	("150", "Dom", 10.0): 2,
    ("190", "Lun", 9.0): 2,	("190", "Mar", 9.0): 2,	("190", "Mie", 9.0): 2,	("190", "Jue", 9.0): 2,	("190", "Vie", 9.0): 2,	("190", "Sab", 9.0): 2,	("190", "Dom", 9.5): 2,
    ("200", "Lun", 9.0): 2,	("200", "Mar", 9.0): 2,	("200", "Mie", 9.0): 2,	("200", "Jue", 9.0): 2,	("200", "Vie", 9.0): 2,	("200", "Sab", 9.0): 2,	("200", "Dom", 9.5): 2,
    ("240", "Lun", 8.0): 1,	("240", "Mar", 8.0): 1,	("240", "Mie", 8.0): 1,	("240", "Jue", 8.0): 1,	("240", "Vie", 8.5): 1,	("240", "Sab", 8.5): 1,	("240", "Dom", 10.0): 1,
    ("250", "Lun", 8.0): 1,	("250", "Mar", 8.0): 1,	("250", "Mie", 8.0): 1,	("250", "Jue", 8.0): 1,	("250", "Vie", 8.5): 1,	("250", "Sab", 8.5): 1,	("250", "Dom", 10.0): 1,
    ("350", "Lun", 8.0): 2,	("350", "Mar", 8.0): 2,	("350", "Mie", 8.0): 2,	("350", "Jue", 8.0): 2,	("350", "Vie", 8.0): 2,	("350", "Sab", 8.0): 2,	("350", "Dom", 8.5): 2,
    ("380", "Lun", 9.0): 2,	("380", "Mar", 9.0): 2,	("380", "Mie", 9.0): 2,	("380", "Jue", 9.0): 2,	("380", "Vie", 9.0): 2,	("380", "Sab", 9.0): 2,	("380", "Dom", 9.5): 2,
    ("390", "Lun", 9.0): 2,	("390", "Mar", 9.0): 2,	("390", "Mie", 9.0): 2,	("390", "Jue", 9.0): 2,	("390", "Vie", 9.0): 2,	("390", "Sab", 9.0): 2,	("390", "Dom", 9.5): 2,
    ("420", "Lun", 9.5): 3,	("420", "Mar", 9.5): 3,	("420", "Mie", 9.5): 3,	("420", "Jue", 9.5): 3,	("420", "Vie", 9.5): 3,	("420", "Sab", 9.0): 3,	("420", "Dom", 9.5): 3,
    ("440", "Lun", 10.0): 2,	("440", "Mar", 10.0): 2,	("440", "Mie", 10.0): 2,	("440", "Jue", 10.0): 2,	("440", "Vie", 10.0): 2,	("440", "Sab", 10.0): 2,	("440", "Dom", 11.0): 2,
    ("460", "Lun", 8.0): 1,	("460", "Mar", 8.0): 1,	("460", "Mie", 8.0): 1,	("460", "Jue", 8.0): 1,	("460", "Vie", 8.5): 1,	("460", "Sab", 8.5): 1,	("460", "Dom", 10.0): 1,
    ("490", "Lun", 9.0): 2,	("490", "Mar", 9.0): 2,	("490", "Mie", 9.0): 2,	("490", "Jue", 9.0): 2,	("490", "Vie", 9.0): 2,	("490", "Sab", 9.0): 2,	("490", "Dom", 9.5): 2,
    ("510", "Lun", 9.0): 1,	("510", "Mar", 9.0): 1,	("510", "Mie", 9.0): 1,	("510", "Jue", 9.0): 1,	("510", "Vie", 9.0): 1,	("510", "Sab", 9.0): 1,	("510", "Dom", 11.0): 1,
    ("520", "Lun", 8.5): 2,	("520", "Mar", 8.5): 2,	("520", "Mie", 8.5): 2,	("520", "Jue", 8.5): 2,	("520", "Vie", 8.5): 2,	("520", "Sab", 8.5): 2,	("520", "Dom", 8.5): 2,
    ("524", "Lun", 9.5): 1,	("524", "Mar", 9.5): 1,	("524", "Mie", 9.5): 1,	("524", "Jue", 9.5): 1,	("524", "Vie", 9.5): 1,	("524", "Sab", 9.5): 1,	("524", "Dom", 10.0): 1,
    ("530", "Lun", 8.0): 1,	("530", "Mar", 8.0): 1,	("530", "Mie", 8.0): 1,	("530", "Jue", 8.0): 1,	("530", "Vie", 8.5): 1,	("530", "Sab", 8.5): 1,	("530", "Dom", 10.0): 1,
    ("532", "Lun", 10.0): 1,	("532", "Mar", 10.0): 1,	("532", "Mie", 10.0): 1,	("532", "Jue", 10.0): 1,	("532", "Vie", 10.0): 1,	("532", "Sab", 10.0): 1,	("532", "Dom", 10.0): 1,
    ("533", "Lun", 10.0): 2,	("533", "Mar", 10.0): 2,	("533", "Mie", 10.0): 2,	("533", "Jue", 10.0): 2,	("533", "Vie", 10.0): 2,	("533", "Sab", 10.0): 2,	("533", "Dom", 10.0): 2,
    ("534", "Lun", 9.5): 1,	("534", "Mar", 9.5): 1,	("534", "Mie", 9.5): 1,	("534", "Jue", 9.5): 1,	("534", "Vie", 9.5): 1,	("534", "Sab", 9.5): 1,	("534", "Dom", 10.0): 1,
    ("535", "Lun", 9.0): 2,	("535", "Mar", 9.0): 2,	("535", "Mie", 9.0): 2,	("535", "Jue", 9.0): 2,	("535", "Vie", 9.0): 2,	("535", "Sab", 9.0): 2,	("535", "Dom", 9.5): 2,
    ("536", "Lun", 9.0): 2,	("536", "Mar", 9.0): 2,	("536", "Mie", 9.0): 2,	("536", "Jue", 9.0): 2,	("536", "Vie", 9.0): 2,	("536", "Sab", 9.0): 2,	("536", "Dom", 9.5): 2,
    ("539", "Lun", 10.0): 1,	("539", "Mar", 10.0): 1,	("539", "Mie", 10.0): 1,	("539", "Jue", 10.0): 1,	("539", "Vie", 10.0): 1,	("539", "Sab", 10.0): 1,	("539", "Dom", 10.0): 1,
    ("540", "Lun", 9.5): 1,	("540", "Mar", 9.5): 1,	("540", "Mie", 9.5): 1,	("540", "Jue", 9.5): 1,	("540", "Vie", 9.5): 1,	("540", "Sab", 9.0): 1,	("540", "Dom", 9.5): 1,
    ("541", "Lun", 10.0): 2,	("541", "Mar", 10.0): 2,	("541", "Mie", 10.0): 2,	("541", "Jue", 10.0): 2,	("541", "Vie", 10.0): 2,	("541", "Sab", 10.0): 2,	("541", "Dom", 10.0): 2,
    ("545", "Lun", 10.0): 1,	("545", "Mar", 10.0): 1,	("545", "Mie", 10.0): 1,	("545", "Jue", 10.0): 1,	("545", "Vie", 10.0): 1,	("545", "Sab", 10.0): 1,	("545", "Dom", 10.0): 1,
    ("546", "Lun", 10.0): 2,	("546", "Mar", 10.0): 2,	("546", "Mie", 10.0): 2,	("546", "Jue", 10.0): 2,	("546", "Vie", 10.0): 2,	("546", "Sab", 10.0): 2,	("546", "Dom", 10.0): 2,
    ("548", "Lun", 10.0): 1,	("548", "Mar", 10.0): 1,	("548", "Mie", 10.0): 1,	("548", "Jue", 10.0): 1,	("548", "Vie", 10.0): 1,	("548", "Sab", 10.0): 1,	("548", "Dom", 10.0): 1,
    ("550", "Lun", 9.0): 1,	("550", "Mar", 9.0): 1,	("550", "Mie", 9.0): 1,	("550", "Jue", 9.0): 1,	("550", "Vie", 9.0): 1,	("550", "Sab", 9.0): 1,	("550", "Dom", 9.5): 1,
    ("551", "Lun", 10.0): 1,	("551", "Mar", 10.0): 1,	("551", "Mie", 10.0): 1,	("551", "Jue", 10.0): 1,	("551", "Vie", 10.0): 1,	("551", "Sab", 10.0): 1,	("551", "Dom", 10.0): 1,
    ("552", "Lun", 5.0): 1,	("552", "Mar", 5.0): 1,	("552", "Mie", 5.0): 1,	("552", "Jue", 5.0): 1,	("552", "Vie", 5.0): 1,	("552", "Sab", 5.0): 1,	("552", "Dom", 5.0): 1,
    ("554", "Lun", 10.0): 1,	("554", "Mar", 10.0): 1,	("554", "Mie", 10.0): 1,	("554", "Jue", 10.0): 1,	("554", "Vie", 10.0): 1,	("554", "Sab", 9.5): 1,	("554", "Dom", 10.0): 1,
    ("557", "Lun", 10.0): 1,	("557", "Mar", 10.0): 1,	("557", "Mie", 10.0): 1,	("557", "Jue", 10.0): 1,	("557", "Vie", 10.0): 1,	("557", "Sab", 10.0): 1,	("557", "Dom", 10.0): 1,
    ("620", "Lun", 10.0): 2,	("620", "Mar", 10.0): 2,	("620", "Mie", 10.0): 2,	("620", "Jue", 10.0): 2,	("620", "Vie", 10.0): 2,	("620", "Sab", 10.0): 2,	("620", "Dom", 11.0): 2,
    ("621", "Lun", 10.0): 2,	("621", "Mar", 10.0): 2,	("621", "Mie", 10.0): 2,	("621", "Jue", 10.0): 2,	("621", "Vie", 10.0): 2,	("621", "Sab", 10.0): 2,	("621", "Dom", 11.0): 2,
    ("630", "Lun", 10.0): 1,	("630", "Mar", 10.0): 1,	("630", "Mie", 10.0): 1,	("630", "Jue", 10.0): 1,	("630", "Vie", 10.0): 1,	("630", "Sab", 10.0): 1,	("630", "Dom", 10.0): 1,
    ("640", "Lun", 10.0): 1,	("640", "Mar", 10.0): 1,	("640", "Mie", 10.0): 1,	("640", "Jue", 10.0): 1,	("640", "Vie", 10.0): 1,	("640", "Sab", 10.0): 1,	("640", "Dom", 11.0): 1,
    ("660", "Lun", 8.5): 1,	("660", "Mar", 8.5): 1,	("660", "Mie", 8.5): 1,	("660", "Jue", 8.5): 1,	("660", "Vie", 8.5): 1,	("660", "Sab", 8.5): 1,	("660", "Dom", 8.5): 1,
    ("670", "Lun", 8.0): 3,	("670", "Mar", 8.0): 3,	("670", "Mie", 8.0): 3,	("670", "Jue", 8.0): 3,	("670", "Vie", 8.0): 3,	("670", "Sab", 8.0): 3,	("670", "Dom", 8.5): 3,
    ("740", "Lun", 8.5): 1,	("740", "Mar", 8.5): 1,	("740", "Mie", 8.5): 1,	("740", "Jue", 8.5): 1,	("740", "Vie", 8.5): 1,	("740", "Sab", 8.5): 1,	("740", "Dom", 10.0): 1,
    ("770", "Lun", 10.0): 1,	("770", "Mar", 10.0): 1,	("770", "Mie", 10.0): 1,	("770", "Jue", 10.0): 1,	("770", "Vie", 10.0): 1,	("770", "Sab", 10.0): 1,	("770", "Dom", 10.0): 1,
    ("780", "Lun", 9.0): 1,	("780", "Mar", 9.0): 1,	("780", "Mie", 9.0): 1,	("780", "Jue", 9.0): 1,	("780", "Vie", 9.0): 1,	("780", "Sab", 9.0): 1,	("780", "Dom", 10.0): 1,
    ("781", "Lun", 9.0): 1,	("781", "Mar", 9.0): 1,	("781", "Mie", 9.0): 1,	("781", "Jue", 9.0): 1,	("781", "Vie", 9.0): 1,	("781", "Sab", 9.0): 1,	("781", "Dom", 10.0): 1,
    ("790", "Lun", 10.0): 1,	("790", "Mar", 10.0): 1,	("790", "Mie", 10.0): 1,	("790", "Jue", 10.0): 1,	("790", "Vie", 10.0): 1,	("790", "Sab", 10.0): 1,	("790", "Dom", 11.0): 1,
    ("810", "Lun", 10.0): 2,	("810", "Mar", 10.0): 2,	("810", "Mie", 10.0): 2,	("810", "Jue", 10.0): 2,	("810", "Vie", 10.0): 2,	("810", "Sab", 10.0): 2,	("810", "Dom", 10.0): 2,
    ("813", "Lun", 10.0): 2,	("813", "Mar", 10.0): 2,	("813", "Mie", 10.0): 2,	("813", "Jue", 10.0): 2,	("813", "Vie", 10.0): 2,	("813", "Sab", 9.5): 2,	("813", "Dom", 10.0): 2,
    ("815", "Lun", 10.0): 2,	("815", "Mar", 10.0): 2,	("815", "Mie", 10.0): 2,	("815", "Jue", 10.0): 2,	("815", "Vie", 10.0): 2,	("815", "Sab", 9.5): 2,	("815", "Dom", 10.0): 2,
    ("817", "Lun", 10.0): 1,	("817", "Mar", 10.0): 1,	("817", "Mie", 10.0): 1,	("817", "Jue", 10.0): 1,	("817", "Vie", 10.0): 1,	("817", "Sab", 9.5): 1,	("817", "Dom", 10.0): 1,
    ("818", "Lun", 10.0): 3,	("818", "Mar", 10.0): 3,	("818", "Mie", 10.0): 3,	("818", "Jue", 10.0): 3,	("818", "Vie", 10.0): 3,	("818", "Sab", 9.5): 3,	("818", "Dom", 10.0): 3,
    ("819", "Lun", 8.5): 2,	("819", "Mar", 8.5): 2,	("819", "Mie", 8.5): 2,	("819", "Jue", 8.5): 2,	("819", "Vie", 8.5): 2,	("819", "Sab", 8.5): 2,	("819", "Dom", 9.0): 2,
    ("820", "Lun", 8.5): 2,	("820", "Mar", 8.5): 2,	("820", "Mie", 8.5): 2,	("820", "Jue", 8.5): 2,	("820", "Vie", 8.5): 2,	("820", "Sab", 8.5): 2,	("820", "Dom", 10.0): 2,
    ("821", "Lun", 10.0): 2,	("821", "Mar", 10.0): 2,	("821", "Mie", 10.0): 2,	("821", "Jue", 10.0): 2,	("821", "Vie", 10.0): 2,	("821", "Sab", 10.0): 2,	("821", "Dom", 10.0): 2,
    ("822", "Lun", 8.0): 2,	("822", "Mar", 8.0): 2,	("822", "Mie", 8.0): 2,	("822", "Jue", 8.0): 2,	("822", "Vie", 8.0): 2,	("822", "Sab", 8.0): 2,	("822", "Dom", 8.5): 2,
    ("823", "Lun", 8.0): 2,	("823", "Mar", 8.0): 2,	("823", "Mie", 8.0): 2,	("823", "Jue", 8.0): 2,	("823", "Vie", 8.0): 2,	("823", "Sab", 8.0): 2,	("823", "Dom", 8.5): 2,
    ("824", "Lun", 10.0): 2,	("824", "Mar", 10.0): 2,	("824", "Mie", 10.0): 2,	("824", "Jue", 10.0): 2,	("824", "Vie", 10.0): 2,	("824", "Sab", 10.0): 2,	("824", "Dom", 10.0): 2,
    ("825", "Lun", 10.0): 2,	("825", "Mar", 10.0): 2,	("825", "Mie", 10.0): 2,	("825", "Jue", 10.0): 2,	("825", "Vie", 10.0): 2,	("825", "Sab", 10.0): 2,	("825", "Dom", 10.0): 2,
    ("826", "Lun", 9.5): 2,	("826", "Mar", 9.5): 2,	("826", "Mie", 9.5): 2,	("826", "Jue", 9.5): 2,	("826", "Vie", 9.5): 2,	("826", "Sab", 9.0): 2,	("826", "Dom", 9.5): 2,
    ("827", "Lun", 9.5): 2,	("827", "Mar", 9.5): 2,	("827", "Mie", 9.5): 2,	("827", "Jue", 9.5): 2,	("827", "Vie", 9.5): 2,	("827", "Sab", 9.0): 2,	("827", "Dom", 9.5): 2,
    ("828", "Lun", 8.5): 3,	("828", "Mar", 8.5): 3,	("828", "Mie", 8.5): 3,	("828", "Jue", 8.5): 3,	("828", "Vie", 8.5): 3,	("828", "Sab", 8.5): 3,	("828", "Dom", 9.0): 3,
    ("829", "Lun", 9.5): 1,	("829", "Mar", 9.5): 1,	("829", "Mie", 9.5): 1,	("829", "Jue", 9.5): 1,	("829", "Vie", 9.5): 1,	("829", "Sab", 9.0): 1,	("829", "Dom", 9.5): 1,
    ("830", "Lun", 10.0): 1,	("830", "Mar", 10.0): 1,	("830", "Mie", 10.0): 1,	("830", "Jue", 10.0): 1,	("830", "Vie", 10.0): 1,	("830", "Sab", 10.0): 1,	("830", "Dom", 11.0): 1,
    ("831", "Lun", 8.0): 2,	("831", "Mar", 8.0): 2,	("831", "Mie", 8.0): 2,	("831", "Jue", 8.0): 2,	("831", "Vie", 8.0): 2,	("831", "Sab", 8.0): 2,	("831", "Dom", 8.5): 2,
    ("833", "Lun", 10.0): 1,	("833", "Mar", 10.0): 1,	("833", "Mie", 10.0): 1,	("833", "Jue", 10.0): 1,	("833", "Vie", 10.0): 1,	("833", "Sab", 10.0): 1,	("833", "Dom", 10.0): 1,
    ("835", "Lun", 9.5): 2,	("835", "Mar", 9.5): 2,	("835", "Mie", 9.5): 2,	("835", "Jue", 9.5): 2,	("835", "Vie", 9.5): 2,	("835", "Sab", 10.0): 2,	("835", "Dom", 10.0): 2,
    ("836", "Lun", 9.5): 2,	("836", "Mar", 9.5): 2,	("836", "Mie", 9.5): 2,	("836", "Jue", 9.5): 2,	("836", "Vie", 9.5): 2,	("836", "Sab", 9.0): 2,	("836", "Dom", 9.5): 2,
    ("837", "Lun", 10.0): 2,	("837", "Mar", 10.0): 2,	("837", "Mie", 10.0): 2,	("837", "Jue", 10.0): 2,	("837", "Vie", 10.0): 2,	("837", "Sab", 10.0): 2,	("837", "Dom", 10.0): 2,
    ("838", "Lun", 5.0): 1,	("838", "Mar", 5.0): 1,	("838", "Mie", 5.0): 1,	("838", "Jue", 5.0): 1,	("838", "Vie", 5.0): 1,	("838", "Sab", 5.0): 1,	("838", "Dom", 5.0): 1,
    ("839", "Lun", 8.5): 2,	("839", "Mar", 8.5): 2,	("839", "Mie", 8.5): 2,	("839", "Jue", 8.5): 2,	("839", "Vie", 8.5): 2,	("839", "Sab", 8.5): 2,	("839", "Dom", 9.0): 2,
    ("840", "Lun", 10.0): 1,	("840", "Mar", 10.0): 1,	("840", "Mie", 10.0): 1,	("840", "Jue", 10.0): 1,	("840", "Vie", 10.0): 1,	("840", "Sab", 10.0): 1,	("840", "Dom", 11.0): 1,
    ("841", "Lun", 8.0): 1,	("841", "Mar", 8.0): 1,	("841", "Mie", 8.0): 1,	("841", "Jue", 8.0): 1,	("841", "Vie", 8.0): 1,	("841", "Sab", 8.0): 1,	("841", "Dom", 8.5): 1,
    ("842", "Lun", 10.0): 2,	("842", "Mar", 10.0): 2,	("842", "Mie", 10.0): 2,	("842", "Jue", 10.0): 2,	("842", "Vie", 10.0): 2,	("842", "Sab", 9.5): 2,	("842", "Dom", 10.0): 2,
    ("843", "Lun", 10.0): 2,	("843", "Mar", 10.0): 2,	("843", "Mie", 10.0): 2,	("843", "Jue", 10.0): 2,	("843", "Vie", 10.0): 2,	("843", "Sab", 9.5): 2,	("843", "Dom", 10.0): 2,
    ("844", "Lun", 10.0): 2,	("844", "Mar", 10.0): 2,	("844", "Mie", 10.0): 2,	("844", "Jue", 10.0): 2,	("844", "Vie", 10.0): 2,	("844", "Sab", 10.0): 2,	("844", "Dom", 10.0): 2,
    ("845", "Lun", 10.0): 2,	("845", "Mar", 10.0): 2,	("845", "Mie", 10.0): 2,	("845", "Jue", 10.0): 2,	("845", "Vie", 10.0): 2,	("845", "Sab", 10.0): 2,	("845", "Dom", 10.0): 2,
    ("846", "Lun", 10.0): 1,	("846", "Mar", 10.0): 1,	("846", "Mie", 10.0): 1,	("846", "Jue", 10.0): 1,	("846", "Vie", 10.0): 1,	("846", "Sab", 10.0): 1,	("846", "Dom", 10.0): 1,
    ("847", "Lun", 8.5): 2,	("847", "Mar", 8.5): 2,	("847", "Mie", 8.5): 2,	("847", "Jue", 8.5): 2,	("847", "Vie", 8.5): 2,	("847", "Sab", 8.5): 2,	("847", "Dom", 9.0): 2,
    ("851", "Lun", 10.0): 1,	("851", "Mar", 10.0): 1,	("851", "Mie", 10.0): 1,	("851", "Jue", 10.0): 1,	("851", "Vie", 10.0): 1,	("851", "Sab", 10.0): 1,	("851", "Dom", 10.0): 1,
    ("852", "Lun", 9.5): 2,	("852", "Mar", 9.5): 2,	("852", "Mie", 9.5): 2,	("852", "Jue", 9.5): 2,	("852", "Vie", 9.5): 2,	("852", "Sab", 9.0): 2,	("852", "Dom", 9.5): 2,
    ("856", "Lun", 9.0): 2,	("856", "Mar", 9.0): 2,	("856", "Mie", 9.0): 2,	("856", "Jue", 9.0): 2,	("856", "Vie", 9.0): 2,	("856", "Sab", 9.0): 2,	("856", "Dom", 9.5): 2,
    ("858", "Lun", 9.5): 2,	("858", "Mar", 9.5): 2,	("858", "Mie", 9.5): 2,	("858", "Jue", 9.5): 2,	("858", "Vie", 9.5): 2,	("858", "Sab", 9.5): 2,	("858", "Dom", 10.0): 2,
    ("859", "Lun", 8.0): 2,	("859", "Mar", 8.0): 2,	("859", "Mie", 8.0): 2,	("859", "Jue", 8.0): 2,	("859", "Vie", 8.5): 2,	("859", "Sab", 8.5): 2,	("859", "Dom", 10.0): 2,
    ("861", "Lun", 9.5): 1,	("861", "Mar", 9.5): 1,	("861", "Mie", 9.5): 1,	("861", "Jue", 9.5): 1,	("861", "Vie", 9.5): 1,	("861", "Sab", 9.5): 1,	("861", "Dom", 10.0): 1,
    ("862", "Lun", 9.0): 3,	("862", "Mar", 9.0): 3,	("862", "Mie", 9.0): 3,	("862", "Jue", 9.0): 3,	("862", "Vie", 9.0): 3,	("862", "Sab", 9.5): 3,	("862", "Dom", 10.0): 3,
    ("863", "Lun", 9.0): 1,	("863", "Mar", 9.0): 1,	("863", "Mie", 9.0): 1,	("863", "Jue", 9.0): 1,	("863", "Vie", 9.0): 1,	("863", "Sab", 9.0): 1,	("863", "Dom", 9.5): 1,
    ("864", "Lun", 10.0): 2,	("864", "Mar", 10.0): 2,	("864", "Mie", 10.0): 2,	("864", "Jue", 10.0): 2,	("864", "Vie", 10.0): 2,	("864", "Sab", 10.0): 2,	("864", "Dom", 10.0): 2,
    ("865", "Lun", 10.0): 1,	("865", "Mar", 10.0): 1,	("865", "Mie", 10.0): 1,	("865", "Jue", 10.0): 1,	("865", "Vie", 10.0): 1,	("865", "Sab", 10.0): 1,	("865", "Dom", 11.0): 1,
    ("866", "Lun", 10.0): 2,	("866", "Mar", 10.0): 2,	("866", "Mie", 10.0): 2,	("866", "Jue", 10.0): 2,	("866", "Vie", 10.0): 2,	("866", "Sab", 10.0): 2,	("866", "Dom", 10.0): 2,
    ("867", "Lun", 10.0): 1,	("867", "Mar", 10.0): 1,	("867", "Mie", 10.0): 1,	("867", "Jue", 10.0): 1,	("867", "Vie", 10.0): 1,	("867", "Sab", 10.0): 1,	("867", "Dom", 11.0): 1,
    ("868", "Lun", 8.5): 3,	("868", "Mar", 8.5): 3,	("868", "Mie", 8.5): 3,	("868", "Jue", 8.5): 3,	("868", "Vie", 8.5): 3,	("868", "Sab", 8.5): 3,	("868", "Dom", 9.0): 3,
    ("869", "Lun", 8.0): 2,	("869", "Mar", 8.0): 2,	("869", "Mie", 8.0): 2,	("869", "Jue", 8.0): 2,	("869", "Vie", 8.0): 2,	("869", "Sab", 8.0): 2,	("869", "Dom", 9.0): 2,
    ("870", "Lun", 10.0): 1,	("870", "Mar", 10.0): 1,	("870", "Mie", 10.0): 1,	("870", "Jue", 10.0): 1,	("870", "Vie", 10.0): 1,	("870", "Sab", 10.0): 1,	("870", "Dom", 11.0): 1,
    ("871", "Lun", 10.0): 1,	("871", "Mar", 10.0): 1,	("871", "Mie", 10.0): 1,	("871", "Jue", 10.0): 1,	("871", "Vie", 10.0): 1,	("871", "Sab", 10.0): 1,	("871", "Dom", 10.0): 1,
    ("872", "Lun", 9.0): 2,	("872", "Mar", 9.0): 2,	("872", "Mie", 9.0): 2,	("872", "Jue", 9.0): 2,	("872", "Vie", 9.0): 2,	("872", "Sab", 9.0): 2,	("872", "Dom", 9.0): 2,
    ("873", "Lun", 9.0): 2,	("873", "Mar", 9.0): 2,	("873", "Mie", 9.0): 2,	("873", "Jue", 9.0): 2,	("873", "Vie", 9.0): 2,	("873", "Sab", 9.0): 2,	("873", "Dom", 9.0): 2,
    ("874", "Lun", 8.0): 2,	("874", "Mar", 8.0): 2,	("874", "Mie", 8.0): 2,	("874", "Jue", 8.0): 2,	("874", "Vie", 8.0): 2,	("874", "Sab", 8.0): 2,	("874", "Dom", 8.5): 2,
    ("876", "Lun", 9.0): 1,	("876", "Mar", 9.0): 1,	("876", "Mie", 9.0): 1,	("876", "Jue", 9.0): 1,	("876", "Vie", 9.0): 1,	("876", "Sab", 9.0): 1,	("876", "Dom", 9.0): 1,
    ("877", "Lun", 9.0): 2,	("877", "Mar", 9.0): 2,	("877", "Mie", 9.0): 2,	("877", "Jue", 9.0): 2,	("877", "Vie", 9.0): 2,	("877", "Sab", 9.0): 2,	("877", "Dom", 9.0): 2,
    ("878", "Lun", 9.0): 1,	("878", "Mar", 9.0): 1,	("878", "Mie", 9.0): 1,	("878", "Jue", 9.0): 1,	("878", "Vie", 9.0): 1,	("878", "Sab", 9.0): 1,	("878", "Dom", 9.0): 1,
    ("879", "Lun", 10.0): 1,	("879", "Mar", 10.0): 1,	("879", "Mie", 10.0): 1,	("879", "Jue", 10.0): 1,	("879", "Vie", 10.0): 1,	("879", "Sab", 10.0): 1,	("879", "Dom", 10.0): 1,
    ("880", "Lun", 9.5): 1,	("880", "Mar", 9.5): 1,	("880", "Mie", 9.5): 1,	("880", "Jue", 9.5): 1,	("880", "Vie", 9.5): 1,	("880", "Sab", 9.0): 1,	("880", "Dom", 9.5): 1,
    ("881", "Lun", 10.0): 1,	("881", "Mar", 10.0): 1,	("881", "Mie", 10.0): 1,	("881", "Jue", 10.0): 1,	("881", "Vie", 10.0): 1,	("881", "Sab", 10.0): 1,	("881", "Dom", 10.0): 1,
    ("882", "Lun", 10.0): 1,	("882", "Mar", 10.0): 1,	("882", "Mie", 10.0): 1,	("882", "Jue", 10.0): 1,	("882", "Vie", 10.0): 1,	("882", "Sab", 10.0): 1,	("882", "Dom", 10.0): 1,
    ("883", "Lun", 9.0): 1,	("883", "Mar", 9.0): 1,	("883", "Mie", 9.0): 1,	("883", "Jue", 9.0): 1,	("883", "Vie", 9.0): 1,	("883", "Sab", 9.0): 1,	("883", "Dom", 10.0): 1,
    ("884", "Lun", 9.5): 2,	("884", "Mar", 9.5): 2,	("884", "Mie", 9.5): 2,	("884", "Jue", 9.5): 2,	("884", "Vie", 9.5): 2,	("884", "Sab", 9.5): 2,	("884", "Dom", 10.0): 2,
    ("885", "Lun", 10.0): 1,	("885", "Mar", 10.0): 1,	("885", "Mie", 10.0): 1,	("885", "Jue", 10.0): 1,	("885", "Vie", 10.0): 1,	("885", "Sab", 10.0): 1,	("885", "Dom", 11.0): 1,
    ("886", "Lun", 9.0): 2,	("886", "Mar", 9.0): 2,	("886", "Mie", 9.0): 2,	("886", "Jue", 9.0): 2,	("886", "Vie", 9.0): 2,	("886", "Sab", 9.0): 2,	("886", "Dom", 9.5): 2,
    ("887", "Lun", 9.0): 2,	("887", "Mar", 9.0): 2,	("887", "Mie", 9.0): 2,	("887", "Jue", 9.0): 2,	("887", "Vie", 9.0): 2,	("887", "Sab", 9.0): 2,	("887", "Dom", 9.0): 2,
    ("888", "Lun", 9.0): 2,	("888", "Mar", 9.0): 2,	("888", "Mie", 9.0): 2,	("888", "Jue", 9.0): 2,	("888", "Vie", 9.0): 2,	("888", "Sab", 9.0): 2,	("888", "Dom", 9.0): 2,
    ("889", "Lun", 9.0): 2,	("889", "Mar", 9.0): 2,	("889", "Mie", 9.0): 2,	("889", "Jue", 9.0): 2,	("889", "Vie", 9.0): 2,	("889", "Sab", 9.0): 2,	("889", "Dom", 9.0): 2,
    ("890", "Lun", 10.0): 1,	("890", "Mar", 10.0): 1,	("890", "Mie", 10.0): 1,	("890", "Jue", 10.0): 1,	("890", "Vie", 10.0): 1,	("890", "Sab", 10.0): 1,	("890", "Dom", 10.0): 1,
    ("891", "Lun", 9.0): 2,	("891", "Mar", 9.0): 2,	("891", "Mie", 9.0): 2,	("891", "Jue", 9.0): 2,	("891", "Vie", 9.0): 2,	("891", "Sab", 9.0): 2,	("891", "Dom", 9.0): 2,
    ("892", "Lun", 9.0): 1,	("892", "Mar", 9.0): 1,	("892", "Mie", 9.0): 1,	("892", "Jue", 9.0): 1,	("892", "Vie", 9.0): 1,	("892", "Sab", 9.0): 1,	("892", "Dom", 9.0): 1,
    ("893", "Lun", 8.0): 2,	("893", "Mar", 8.0): 2,	("893", "Mie", 8.0): 2,	("893", "Jue", 8.0): 2,	("893", "Vie", 8.0): 2,	("893", "Sab", 8.0): 2,	("893", "Dom", 8.5): 2,
    ("894", "Lun", 10.0): 2,	("894", "Mar", 10.0): 2,	("894", "Mie", 10.0): 2,	("894", "Jue", 10.0): 2,	("894", "Vie", 10.0): 2,	("894", "Sab", 10.0): 2,	("894", "Dom", 10.0): 2,
    ("895", "Lun", 8.0): 2,	("895", "Mar", 8.0): 2,	("895", "Mie", 8.0): 2,	("895", "Jue", 8.0): 2,	("895", "Vie", 8.5): 2,	("895", "Sab", 8.5): 2,	("895", "Dom", 10.0): 2,
    ("897", "Lun", 8.5): 2,	("897", "Mar", 8.5): 2,	("897", "Mie", 8.5): 2,	("897", "Jue", 8.5): 2,	("897", "Vie", 8.5): 2,	("897", "Sab", 8.5): 2,	("897", "Dom", 9.0): 2,
    ("898", "Lun", 9.5): 1,	("898", "Mar", 9.5): 1,	("898", "Mie", 9.5): 1,	("898", "Jue", 9.5): 1,	("898", "Vie", 9.5): 1,	("898", "Sab", 9.0): 1,	("898", "Dom", 9.5): 1,
    ("110", "Lun", 20.0): 1,	("110", "Mar", 20.0): 1,	("110", "Mie", 20.0): 1,	("110", "Jue", 20.0): 1,	("110", "Vie", 20.0): 1,	("110", "Sab", 20.0): 1,	("110", "Dom", 16.5): 1,
    ("120", "Lun", 19.5): 2,	("120", "Mar", 19.5): 2,	("120", "Mie", 19.5): 2,	("120", "Jue", 19.5): 2,	("120", "Vie", 19.5): 2,	("120", "Sab", 19.5): 2,	("120", "Dom", 18.5): 2,
    ("140", "Lun", 19.5): 2,	("140", "Mar", 19.5): 2,	("140", "Mie", 19.5): 2,	("140", "Jue", 19.5): 2,	("140", "Vie", 19.5): 2,	("140", "Sab", 19.5): 2,	("140", "Dom", 18.5): 2,
    ("150", "Lun", 19.5): 2,	("150", "Mar", 19.5): 2,	("150", "Mie", 19.5): 2,	("150", "Jue", 19.5): 2,	("150", "Vie", 19.5): 2,	("150", "Sab", 19.5): 2,	("150", "Dom", 18.5): 2,
    ("190", "Lun", 20.0): 2,	("190", "Mar", 20.0): 2,	("190", "Mie", 20.0): 2,	("190", "Jue", 20.0): 2,	("190", "Vie", 20.5): 2,	("190", "Sab", 20.5): 2,	("190", "Dom", 20.0): 2,
    ("200", "Lun", 20.0): 2,	("200", "Mar", 20.0): 2,	("200", "Mie", 20.0): 2,	("200", "Jue", 20.0): 2,	("200", "Vie", 20.0): 2,	("200", "Sab", 20.5): 2,	("200", "Dom", 20.0): 2,
    ("240", "Lun", 19.0): 2,	("240", "Mar", 19.0): 2,	("240", "Mie", 19.0): 2,	("240", "Jue", 19.0): 2,	("240", "Vie", 19.5): 2,	("240", "Sab", 19.5): 2,	("240", "Dom", 17.5): 2,
    ("250", "Lun", 19.0): 1,	("250", "Mar", 19.0): 1,	("250", "Mie", 19.0): 1,	("250", "Jue", 19.0): 1,	("250", "Vie", 19.5): 1,	("250", "Sab", 19.5): 1,	("250", "Dom", 17.5): 1,
    ("350", "Lun", 19.0): 2,	("350", "Mar", 19.0): 2,	("350", "Mie", 19.0): 2,	("350", "Jue", 19.0): 2,	("350", "Vie", 19.5): 2,	("350", "Sab", 19.5): 2,	("350", "Dom", 13.5): 2,
    ("380", "Lun", 20.0): 2,	("380", "Mar", 20.0): 2,	("380", "Mie", 20.0): 2,	("380", "Jue", 20.0): 2,	("380", "Vie", 20.5): 2,	("380", "Sab", 20.5): 2,	("380", "Dom", 20.0): 2,
    ("390", "Lun", 20.0): 2,	("390", "Mar", 20.0): 2,	("390", "Mie", 20.0): 2,	("390", "Jue", 20.0): 2,	("390", "Vie", 20.5): 2,	("390", "Sab", 20.5): 2,	("390", "Dom", 20.0): 2,
    ("420", "Lun", 20.0): 3,	("420", "Mar", 20.0): 3,	("420", "Mie", 20.0): 3,	("420", "Jue", 20.0): 3,	("420", "Vie", 20.5): 3,	("420", "Sab", 20.5): 3,	("420", "Dom", 20.0): 3,
    ("440", "Lun", 20.0): 3,	("440", "Mar", 20.0): 3,	("440", "Mie", 20.0): 3,	("440", "Jue", 20.0): 3,	("440", "Vie", 20.5): 3,	("440", "Sab", 20.5): 3,	("440", "Dom", 19.0): 3,
    ("460", "Lun", 19.0): 1,	("460", "Mar", 19.0): 1,	("460", "Mie", 19.0): 1,	("460", "Jue", 19.0): 1,	("460", "Vie", 19.5): 1,	("460", "Sab", 19.5): 1,	("460", "Dom", 17.5): 1,
    ("490", "Lun", 20.0): 2,	("490", "Mar", 20.0): 2,	("490", "Mie", 20.0): 2,	("490", "Jue", 20.0): 2,	("490", "Vie", 20.5): 2,	("490", "Sab", 20.5): 2,	("490", "Dom", 20.0): 2,
    ("510", "Lun", 19.5): 1,	("510", "Mar", 19.5): 1,	("510", "Mie", 19.5): 1,	("510", "Jue", 19.5): 1,	("510", "Vie", 19.5): 1,	("510", "Sab", 19.5): 1,	("510", "Dom", 17.5): 1,
    ("520", "Lun", 19.5): 2,	("520", "Mar", 19.5): 2,	("520", "Mie", 19.5): 2,	("520", "Jue", 19.5): 2,	("520", "Vie", 19.5): 2,	("520", "Sab", 20.5): 2,	("520", "Dom", 17.0): 2,
    ("524", "Lun", 20.0): 2,	("524", "Mar", 20.0): 2,	("524", "Mie", 20.0): 2,	("524", "Jue", 20.0): 2,	("524", "Vie", 20.5): 2,	("524", "Sab", 20.5): 2,	("524", "Dom", 19.5): 2,
    ("530", "Lun", 19): 1,	("530", "Mar", 19): 1,	("530", "Mie", 19): 1,	("530", "Jue", 19): 1,	("530", "Vie", 19.5): 1,	("530", "Sab", 19.5): 1,	("530", "Dom", 17.5): 1,
    ("532", "Lun", 20.5): 2,	("532", "Mar", 20.5): 2,	("532", "Mie", 20.5): 2,	("532", "Jue", 20.5): 2,	("532", "Vie", 20.5): 2,	("532", "Sab", 20.5): 2,	("532", "Dom", 19.5): 2,
    ("533", "Lun", 20.5): 2,	("533", "Mar", 20.5): 2,	("533", "Mie", 20.5): 2,	("533", "Jue", 20.5): 2,	("533", "Vie", 20.5): 2,	("533", "Sab", 20.5): 2,	("533", "Dom", 19.5): 2,
    ("534", "Lun", 20): 2,	("534", "Mar", 20): 2,	("534", "Mie", 20): 2,	("534", "Jue", 20): 2,	("534", "Vie", 20.5): 2,	("534", "Sab", 20.5): 2,	("534", "Dom", 20): 2,
    ("535", "Lun", 19.5): 3,	("535", "Mar", 19.5): 3,	("535", "Mie", 19.5): 3,	("535", "Jue", 19.5): 3,	("535", "Vie", 19.5): 3,	("535", "Sab", 19.5): 3,	("535", "Dom", 18.5): 3,
    ("536", "Lun", 19.5): 3,	("536", "Mar", 19.5): 3,	("536", "Mie", 19.5): 3,	("536", "Jue", 19.5): 3,	("536", "Vie", 19.5): 3,	("536", "Sab", 19.5): 3,	("536", "Dom", 18.5): 3,
    ("539", "Lun", 20.5): 2,	("539", "Mar", 20.5): 2,	("539", "Mie", 20.5): 2,	("539", "Jue", 20.5): 2,	("539", "Vie", 21): 2,	("539", "Sab", 21): 2,	("539", "Dom", 19.5): 2,
    ("540", "Lun", 20): 2,	("540", "Mar", 20): 2,	("540", "Mie", 20): 2,	("540", "Jue", 20): 2,	("540", "Vie", 20.5): 2,	("540", "Sab", 20.5): 2,	("540", "Dom", 20): 2,
    ("541", "Lun", 20.5): 2,	("541", "Mar", 20.5): 2,	("541", "Mie", 20.5): 2,	("541", "Jue", 20.5): 2,	("541", "Vie", 21): 2,	("541", "Sab", 21): 2,	("541", "Dom", 19.5): 2,
    ("545", "Lun", 20.5): 1,	("545", "Mar", 20.5): 1,	("545", "Mie", 20.5): 1,	("545", "Jue", 20.5): 1,	("545", "Vie", 20.5): 1,	("545", "Sab", 20.5): 1,	("545", "Dom", 19.5): 1,
    ("546", "Lun", 20.5): 2,	("546", "Mar", 20.5): 2,	("546", "Mie", 20.5): 2,	("546", "Jue", 20.5): 2,	("546", "Vie", 20.5): 2,	("546", "Sab", 20.5): 2,	("546", "Dom", 19.5): 2,
    ("548", "Lun", 20.5): 1,	("548", "Mar", 20.5): 1,	("548", "Mie", 20.5): 1,	("548", "Jue", 20.5): 1,	("548", "Vie", 20.5): 1,	("548", "Sab", 21): 1,	("548", "Dom", 20): 1,
    ("550", "Lun", 20): 1,	("550", "Mar", 20): 1,	("550", "Mie", 20): 1,	("550", "Jue", 20): 1,	("550", "Vie", 20): 1,	("550", "Sab", 20.5): 1,	("550", "Dom", 20): 1,
    ("551", "Lun", 20.5): 1,	("551", "Mar", 20.5): 1,	("551", "Mie", 20.5): 1,	("551", "Jue", 20.5): 1,	("551", "Vie", 20.5): 1,	("551", "Sab", 20.5): 1,	("551", "Dom", 19.5): 1,
    ("552", "Lun", 21.5): 1,	("552", "Mar", 21.5): 1,	("552", "Mie", 21.5): 1,	("552", "Jue", 21.5): 1,	("552", "Vie", 21.5): 1,	("552", "Sab", 21.5): 1,	("552", "Dom", 21.5): 1,
    ("554", "Lun", 20): 1,	("554", "Mar", 20): 1,	("554", "Mie", 20): 1,	("554", "Jue", 20): 1,	("554", "Vie", 20.5): 1,	("554", "Sab", 20.5): 1,	("554", "Dom", 20): 1,
    ("557", "Lun", 20.5): 1,	("557", "Mar", 20.5): 1,	("557", "Mie", 20.5): 1,	("557", "Jue", 20.5): 1,	("557", "Vie", 20.5): 1,	("557", "Sab", 20.5): 1,	("557", "Dom", 19.5): 1,
    ("620", "Lun", 20): 2,	("620", "Mar", 20): 2,	("620", "Mie", 20): 2,	("620", "Jue", 20): 2,	("620", "Vie", 20.5): 2,	("620", "Sab", 20.5): 2,	("620", "Dom", 19): 2,
    ("621", "Lun", 20): 2,	("621", "Mar", 20): 2,	("621", "Mie", 20): 2,	("621", "Jue", 20): 2,	("621", "Vie", 20.5): 2,	("621", "Sab", 20.5): 2,	("621", "Dom", 19): 2,
    ("630", "Lun", 19.5): 1,	("630", "Mar", 19.5): 1,	("630", "Mie", 19.5): 1,	("630", "Jue", 19.5): 1,	("630", "Vie", 20.5): 1,	("630", "Sab", 20.5): 1,	("630", "Dom", 19.5): 1,
    ("640", "Lun", 20): 1,	("640", "Mar", 20): 1,	("640", "Mie", 20): 1,	("640", "Jue", 20): 1,	("640", "Vie", 20.5): 1,	("640", "Sab", 20.5): 1,	("640", "Dom", 19): 1,
    ("660", "Lun", 19.5): 2,	("660", "Mar", 19.5): 2,	("660", "Mie", 19.5): 2,	("660", "Jue", 19.5): 2,	("660", "Vie", 19.5): 2,	("660", "Sab", 20.5): 2,	("660", "Dom", 17): 2,
    ("670", "Lun", 19): 3,	("670", "Mar", 19): 3,	("670", "Mie", 19): 3,	("670", "Jue", 19): 3,	("670", "Vie", 19.5): 3,	("670", "Sab", 19.5): 3,	("670", "Dom", 13.5): 3,
    ("740", "Lun", 19.5): 2,	("740", "Mar", 19.5): 2,	("740", "Mie", 19.5): 2,	("740", "Jue", 19.5): 2,	("740", "Vie", 19.5): 2,	("740", "Sab", 20): 2,	("740", "Dom", 13.5): 2,
    ("770", "Lun", 20.5): 2,	("770", "Mar", 20.5): 2,	("770", "Mie", 20.5): 2,	("770", "Jue", 20.5): 2,	("770", "Vie", 20.5): 2,	("770", "Sab", 20.5): 2,	("770", "Dom", 19.5): 2,
    ("780", "Lun", 20.5): 2,	("780", "Mar", 20.5): 2,	("780", "Mie", 20.5): 2,	("780", "Jue", 20.5): 2,	("780", "Vie", 20.5): 2,	("780", "Sab", 20.5): 2,	("780", "Dom", 19.5): 2,
    ("781", "Lun", 20.5): 2,	("781", "Mar", 20.5): 2,	("781", "Mie", 20.5): 2,	("781", "Jue", 20.5): 2,	("781", "Vie", 20.5): 2,	("781", "Sab", 20.5): 2,	("781", "Dom", 19.5): 2,
    ("790", "Lun", 20.5): 2,	("790", "Mar", 20.5): 2,	("790", "Mie", 20.5): 2,	("790", "Jue", 20.5): 2,	("790", "Vie", 20.5): 2,	("790", "Sab", 20.5): 2,	("790", "Dom", 19.5): 2,
    ("810", "Lun", 19.5): 2,	("810", "Mar", 19.5): 2,	("810", "Mie", 19.5): 2,	("810", "Jue", 19.5): 2,	("810", "Vie", 20.5): 2,	("810", "Sab", 20.5): 2,	("810", "Dom", 19.5): 2,
    ("813", "Lun", 20.5): 2,	("813", "Mar", 20.5): 2,	("813", "Mie", 20.5): 2,	("813", "Jue", 20.5): 2,	("813", "Vie", 20.5): 2,	("813", "Sab", 21): 2,	("813", "Dom", 20): 2,
    ("815", "Lun", 20.5): 2,	("815", "Mar", 20.5): 2,	("815", "Mie", 20.5): 2,	("815", "Jue", 20.5): 2,	("815", "Vie", 20.5): 2,	("815", "Sab", 21): 2,	("815", "Dom", 20): 2,
    ("817", "Lun", 20): 1,	("817", "Mar", 20): 1,	("817", "Mie", 20): 1,	("817", "Jue", 20): 1,	("817", "Vie", 20): 1,	("817", "Sab", 20.5): 1,	("817", "Dom", 20): 1,
    ("818", "Lun", 20): 3,	("818", "Mar", 20): 3,	("818", "Mie", 20): 3,	("818", "Jue", 20): 3,	("818", "Vie", 20.5): 3,	("818", "Sab", 20.5): 3,	("818", "Dom", 20): 3,
    ("819", "Lun", 19): 2,	("819", "Mar", 19): 2,	("819", "Mie", 19): 2,	("819", "Jue", 19): 2,	("819", "Vie", 19.5): 2,	("819", "Sab", 19.5): 2,	("819", "Dom", 17.5): 2,
    ("820", "Lun", 19.5): 2,	("820", "Mar", 19.5): 2,	("820", "Mie", 19.5): 2,	("820", "Jue", 19.5): 2,	("820", "Vie", 19.5): 2,	("820", "Sab", 20): 2,	("820", "Dom", 13.5): 2,
    ("821", "Lun", 20.5): 2,	("821", "Mar", 20.5): 2,	("821", "Mie", 20.5): 2,	("821", "Jue", 20.5): 2,	("821", "Vie", 20.5): 2,	("821", "Sab", 21): 2,	("821", "Dom", 20): 2,
    ("822", "Lun", 20.5): 2,	("822", "Mar", 20.5): 2,	("822", "Mie", 20.5): 2,	("822", "Jue", 20.5): 2,	("822", "Vie", 20.5): 2,	("822", "Sab", 21): 2,	("822", "Dom", 20): 2,
    ("823", "Lun", 19): 2,	("823", "Mar", 19): 2,	("823", "Mie", 19): 2,	("823", "Jue", 19): 2,	("823", "Vie", 19.5): 2,	("823", "Sab", 19.5): 2,	("823", "Dom", 17.5): 2,
    ("824", "Lun", 19.5): 2,	("824", "Mar", 19.5): 2,	("824", "Mie", 19.5): 2,	("824", "Jue", 19.5): 2,	("824", "Vie", 20.5): 2,	("824", "Sab", 20.5): 2,	("824", "Dom", 19.5): 2,
    ("825", "Lun", 20.5): 2,	("825", "Mar", 20.5): 2,	("825", "Mie", 20.5): 2,	("825", "Jue", 20.5): 2,	("825", "Vie", 20.5): 2,	("825", "Sab", 20.5): 2,	("825", "Dom", 19.5): 2,
    ("826", "Lun", 20): 2,	("826", "Mar", 20): 2,	("826", "Mie", 20): 2,	("826", "Jue", 20): 2,	("826", "Vie", 20): 2,	("826", "Sab", 20.5): 2,	("826", "Dom", 20): 2,
    ("827", "Lun", 20): 2,	("827", "Mar", 20): 2,	("827", "Mie", 20): 2,	("827", "Jue", 20): 2,	("827", "Vie", 20): 2,	("827", "Sab", 20.5): 2,	("827", "Dom", 20): 2,
    ("828", "Lun", 19): 3,	("828", "Mar", 19): 3,	("828", "Mie", 19): 3,	("828", "Jue", 19): 3,	("828", "Vie", 19.5): 3,	("828", "Sab", 19.5): 3,	("828", "Dom", 17.5): 3,
    ("829", "Lun", 20): 2,	("829", "Mar", 20): 2,	("829", "Mie", 20): 2,	("829", "Jue", 20): 2,	("829", "Vie", 20.5): 2,	("829", "Sab", 20.5): 2,	("829", "Dom", 20): 2,
    ("830", "Lun", 20.5): 2,	("830", "Mar", 20.5): 2,	("830", "Mie", 20.5): 2,	("830", "Jue", 20.5): 2,	("830", "Vie", 20.5): 2,	("830", "Sab", 20.5): 2,	("830", "Dom", 19.5): 2,
    ("831", "Lun", 19): 2,	("831", "Mar", 19): 2,	("831", "Mie", 19): 2,	("831", "Jue", 19): 2,	("831", "Vie", 19.5): 2,	("831", "Sab", 19.5): 2,	("831", "Dom", 17): 2,
    ("833", "Lun", 20): 1,	("833", "Mar", 20): 1,	("833", "Mie", 20): 1,	("833", "Jue", 20): 1,	("833", "Vie", 21): 1,	("833", "Sab", 21): 1,	("833", "Dom", 20): 1,
    ("835", "Lun", 20.5): 2,	("835", "Mar", 20.5): 2,	("835", "Mie", 20.5): 2,	("835", "Jue", 20.5): 2,	("835", "Vie", 20.5): 2,	("835", "Sab", 20.5): 2,	("835", "Dom", 19.5): 2,
    ("836", "Lun", 20): 2,	("836", "Mar", 20): 2,	("836", "Mie", 20): 2,	("836", "Jue", 20): 2,	("836", "Vie", 20): 2,	("836", "Sab", 20.5): 2,	("836", "Dom", 20): 2,
    ("837", "Lun", 20.5): 2,	("837", "Mar", 20.5): 2,	("837", "Mie", 20.5): 2,	("837", "Jue", 20.5): 2,	("837", "Vie", 20.5): 2,	("837", "Sab", 20.5): 2,	("837", "Dom", 19.5): 2,
    ("838", "Lun", 20.5): 1,	("838", "Mar", 20.5): 1,	("838", "Mie", 20.5): 1,	("838", "Jue", 20.5): 1,	("838", "Vie", 20.5): 1,	("838", "Sab", 20.5): 1,	("838", "Dom", 20.5): 1,
    ("839", "Lun", 20): 2,	("839", "Mar", 20): 2,	("839", "Mie", 20): 2,	("839", "Jue", 20): 2,	("839", "Vie", 20): 2,	("839", "Sab", 20): 2,	("839", "Dom", 17): 2,
    ("840", "Lun", 20.5): 2,	("840", "Mar", 20.5): 2,	("840", "Mie", 20.5): 2,	("840", "Jue", 20.5): 2,	("840", "Vie", 20.5): 2,	("840", "Sab", 20.5): 2,	("840", "Dom", 19.5): 2,
    ("841", "Lun", 18.5): 1,	("841", "Mar", 18.5): 1,	("841", "Mie", 18.5): 1,	("841", "Jue", 18.5): 1,	("841", "Vie", 18.5): 1,	("841", "Sab", 18.5): 1,	("841", "Dom", 18.5): 1,
    ("842", "Lun", 20.5): 2,	("842", "Mar", 20.5): 2,	("842", "Mie", 20.5): 2,	("842", "Jue", 20.5): 2,	("842", "Vie", 20.5): 2,	("842", "Sab", 21): 2,	("842", "Dom", 20): 2,
    ("843", "Lun", 20.5): 3,	("843", "Mar", 20.5): 3,	("843", "Mie", 20.5): 3,	("843", "Jue", 20.5): 3,	("843", "Vie", 20.5): 3,	("843", "Sab", 21): 3,	("843", "Dom", 20): 3,
    ("844", "Lun", 20): 2,	("844", "Mar", 20): 2,	("844", "Mie", 20): 2,	("844", "Jue", 20): 2,	("844", "Vie", 21): 2,	("844", "Sab", 21): 2,	("844", "Dom", 19.5): 2,
    ("845", "Lun", 20): 2,	("845", "Mar", 20): 2,	("845", "Mie", 20): 2,	("845", "Jue", 20): 2,	("845", "Vie", 21): 2,	("845", "Sab", 21): 2,	("845", "Dom", 19.5): 2,
    ("846", "Lun", 20.5): 2,	("846", "Mar", 20.5): 2,	("846", "Mie", 20.5): 2,	("846", "Jue", 20.5): 2,	("846", "Vie", 20.5): 2,	("846", "Sab", 20.5): 2,	("846", "Dom", 19.5): 2,
    ("847", "Lun", 19): 3,	("847", "Mar", 19): 3,	("847", "Mie", 19): 3,	("847", "Jue", 19): 3,	("847", "Vie", 19.5): 3,	("847", "Sab", 19.5): 3,	("847", "Dom", 17.5): 3,
    ("851", "Lun", 20.5): 2,	("851", "Mar", 20.5): 2,	("851", "Mie", 20.5): 2,	("851", "Jue", 20.5): 2,	("851", "Vie", 20.5): 2,	("851", "Sab", 20.5): 2,	("851", "Dom", 19.5): 2,
    ("852", "Lun", 20): 2,	("852", "Mar", 20): 2,	("852", "Mie", 20): 2,	("852", "Jue", 20): 2,	("852", "Vie", 20): 2,	("852", "Sab", 20.5): 2,	("852", "Dom", 20): 2,
    ("856", "Lun", 20): 2,	("856", "Mar", 20): 2,	("856", "Mie", 20): 2,	("856", "Jue", 20): 2,	("856", "Vie", 20.5): 2,	("856", "Sab", 20.5): 2,	("856", "Dom", 20): 2,
    ("858", "Lun", 20.5): 2,	("858", "Mar", 20.5): 2,	("858", "Mie", 20.5): 2,	("858", "Jue", 20.5): 2,	("858", "Vie", 20.5): 2,	("858", "Sab", 20.5): 2,	("858", "Dom", 19.5): 2,
    ("859", "Lun", 19): 2,	("859", "Mar", 19): 2,	("859", "Mie", 19): 2,	("859", "Jue", 19): 2,	("859", "Vie", 19.5): 2,	("859", "Sab", 19.5): 2,	("859", "Dom", 17.5): 2,
    ("861", "Lun", 20.5): 1,	("861", "Mar", 20.5): 1,	("861", "Mie", 20.5): 1,	("861", "Jue", 20.5): 1,	("861", "Vie", 20.5): 1,	("861", "Sab", 20.5): 1,	("861", "Dom", 19.5): 1,
    ("862", "Lun", 20.5): 2,	("862", "Mar", 20.5): 2,	("862", "Mie", 20.5): 2,	("862", "Jue", 20.5): 2,	("862", "Vie", 20.5): 2,	("862", "Sab", 21): 2,	("862", "Dom", 20): 2,
    ("863", "Lun", 20): 2,	("863", "Mar", 20): 2,	("863", "Mie", 20): 2,	("863", "Jue", 20): 2,	("863", "Vie", 20): 2,	("863", "Sab", 20): 2,	("863", "Dom", 17): 2,
    ("864", "Lun", 20.5): 2,	("864", "Mar", 20.5): 2,	("864", "Mie", 20.5): 2,	("864", "Jue", 20.5): 2,	("864", "Vie", 20.5): 2,	("864", "Sab", 20.5): 2,	("864", "Dom", 19.5): 2,
    ("865", "Lun", 20.5): 2,	("865", "Mar", 20.5): 2,	("865", "Mie", 20.5): 2,	("865", "Jue", 20.5): 2,	("865", "Vie", 20.5): 2,	("865", "Sab", 20.5): 2,	("865", "Dom", 19.5): 2,
    ("866", "Lun", 20.5): 2,	("866", "Mar", 20.5): 2,	("866", "Mie", 20.5): 2,	("866", "Jue", 20.5): 2,	("866", "Vie", 20.5): 2,	("866", "Sab", 20.5): 2,	("866", "Dom", 19.5): 2,
    ("867", "Lun", 20.5): 2,	("867", "Mar", 20.5): 2,	("867", "Mie", 20.5): 2,	("867", "Jue", 20.5): 2,	("867", "Vie", 20.5): 2,	("867", "Sab", 20.5): 2,	("867", "Dom", 19.5): 2,
    ("868", "Lun", 19): 3,	("868", "Mar", 19): 3,	("868", "Mie", 19): 3,	("868", "Jue", 19): 3,	("868", "Vie", 19.5): 3,	("868", "Sab", 19.5): 3,	("868", "Dom", 17): 3,
    ("869", "Lun", 19.5): 2,	("869", "Mar", 19.5): 2,	("869", "Mie", 19.5): 2,	("869", "Jue", 19.5): 2,	("869", "Vie", 19.5): 2,	("869", "Sab", 19.5): 2,	("869", "Dom", 17.5): 2,
    ("870", "Lun", 20.5): 2,	("870", "Mar", 20.5): 2,	("870", "Mie", 20.5): 2,	("870", "Jue", 20.5): 2,	("870", "Vie", 20.5): 2,	("870", "Sab", 20.5): 2,	("870", "Dom", 19.5): 2,
    ("871", "Lun", 20.5): 2,	("871", "Mar", 20.5): 2,	("871", "Mie", 20.5): 2,	("871", "Jue", 20.5): 2,	("871", "Vie", 20.5): 2,	("871", "Sab", 20.5): 2,	("871", "Dom", 19.5): 2,
    ("872", "Lun", 19.5): 2,	("872", "Mar", 19.5): 2,	("872", "Mie", 19.5): 2,	("872", "Jue", 19.5): 2,	("872", "Vie", 19.5): 2,	("872", "Sab", 19.5): 2,	("872", "Dom", 17.5): 2,
    ("873", "Lun", 19.5): 2,	("873", "Mar", 19.5): 2,	("873", "Mie", 19.5): 2,	("873", "Jue", 19.5): 2,	("873", "Vie", 19.5): 2,	("873", "Sab", 19.5): 2,	("873", "Dom", 17.5): 2,
    ("874", "Lun", 19): 2,	("874", "Mar", 19): 2,	("874", "Mie", 19): 2,	("874", "Jue", 19): 2,	("874", "Vie", 19.5): 2,	("874", "Sab", 19.5): 2,	("874", "Dom", 13.5): 2,
    ("875", "Lun", 19.5): 2,	("875", "Mar", 19.5): 2,	("875", "Mie", 19.5): 2,	("875", "Jue", 19.5): 2,	("875", "Vie", 19.5): 2,	("875", "Sab", 19.5): 2,	("875", "Dom", 17.5): 2,
    ("876", "Lun", 19.5): 2,	("876", "Mar", 19.5): 2,	("876", "Mie", 19.5): 2,	("876", "Jue", 19.5): 2,	("876", "Vie", 19.5): 2,	("876", "Sab", 19.5): 2,	("876", "Dom", 17.5): 2,
    ("877", "Lun", 19.5): 2,	("877", "Mar", 19.5): 2,	("877", "Mie", 19.5): 2,	("877", "Jue", 19.5): 2,	("877", "Vie", 19.5): 2,	("877", "Sab", 19.5): 2,	("877", "Dom", 17.5): 2,
    ("878", "Lun", 19.5): 2,	("878", "Mar", 19.5): 2,	("878", "Mie", 19.5): 2,	("878", "Jue", 19.5): 2,	("878", "Vie", 19.5): 2,	("878", "Sab", 19.5): 2,	("878", "Dom", 17.5): 2,
    ("879", "Lun", 19.5): 1,	("879", "Mar", 19.5): 1,	("879", "Mie", 19.5): 1,	("879", "Jue", 19.5): 1,	("879", "Vie", 20.5): 1,	("879", "Sab", 20.5): 1,	("879", "Dom", 19.5): 1,
    ("880", "Lun", 19.5): 2,	("880", "Mar", 19.5): 2,	("880", "Mie", 19.5): 2,	("880", "Jue", 19.5): 2,	("880", "Vie", 19.5): 2,	("880", "Sab", 19.5): 2,	("880", "Dom", 17.5): 2,
    ("881", "Lun", 19.5): 2,	("881", "Mar", 19.5): 2,	("881", "Mie", 19.5): 2,	("881", "Jue", 19.5): 2,	("881", "Vie", 19.5): 2,	("881", "Sab", 19.5): 2,	("881", "Dom", 17.5): 2,
    ("882", "Lun", 20.5): 2,	("882", "Mar", 20.5): 2,	("882", "Mie", 20.5): 2,	("882", "Jue", 20.5): 2,	("882", "Vie", 20.5): 2,	("882", "Sab", 20.5): 2,	("882", "Dom", 19.5): 2,
    ("883", "Lun", 20.5): 1,	("883", "Mar", 20.5): 1,	("883", "Mie", 20.5): 1,	("883", "Jue", 20.5): 1,	("883", "Vie", 20.5): 1,	("883", "Sab", 20.5): 1,	("883", "Dom", 19.5): 1,
    ("884", "Lun", 20): 2,	("884", "Mar", 20): 2,	("884", "Mie", 20): 2,	("884", "Jue", 20): 2,	("884", "Vie", 20.5): 2,	("884", "Sab", 20.5): 2,	("884", "Dom", 19.5): 2,
    ("885", "Lun", 20): 1,	("885", "Mar", 20): 1,	("885", "Mie", 20): 1,	("885", "Jue", 20): 1,	("885", "Vie", 20.5): 1,	("885", "Sab", 20.5): 1,	("885", "Dom", 19): 1,
    ("886", "Lun", 20): 2,	("886", "Mar", 20): 2,	("886", "Mie", 20): 2,	("886", "Jue", 20): 2,	("886", "Vie", 20.5): 2,	("886", "Sab", 20.5): 2,	("886", "Dom", 20): 2,
    ("887", "Lun", 19.5): 2,	("887", "Mar", 19.5): 2,	("887", "Mie", 19.5): 2,	("887", "Jue", 19.5): 2,	("887", "Vie", 19.5): 2,	("887", "Sab", 19.5): 2,	("887", "Dom", 17.5): 2,
    ("888", "Lun", 19.5): 2,	("888", "Mar", 19.5): 2,	("888", "Mie", 19.5): 2,	("888", "Jue", 19.5): 2,	("888", "Vie", 19.5): 2,	("888", "Sab", 19.5): 2,	("888", "Dom", 17.5): 2,
    ("889", "Lun", 19.5): 2,	("889", "Mar", 19.5): 2,	("889", "Mie", 19.5): 2,	("889", "Jue", 19.5): 2,	("889", "Vie", 19.5): 2,	("889", "Sab", 19.5): 2,	("889", "Dom", 17.5): 2,
    ("890", "Lun", 20.5): 1,	("890", "Mar", 20.5): 1,	("890", "Mie", 20.5): 1,	("890", "Jue", 20.5): 1,	("890", "Vie", 20.5): 1,	("890", "Sab", 21): 1,	("890", "Dom", 20): 1,
    ("891", "Lun", 19.5): 2,	("891", "Mar", 19.5): 2,	("891", "Mie", 19.5): 2,	("891", "Jue", 19.5): 2,	("891", "Vie", 19.5): 2,	("891", "Sab", 19.5): 2,	("891", "Dom", 18.5): 2,
    ("892", "Lun", 19.5): 2,	("892", "Mar", 19.5): 2,	("892", "Mie", 19.5): 2,	("892", "Jue", 19.5): 2,	("892", "Vie", 19.5): 2,	("892", "Sab", 19.5): 2,	("892", "Dom", 18.5): 2,
    ("893", "Lun", 19): 2,	("893", "Mar", 19): 2,	("893", "Mie", 19): 2,	("893", "Jue", 19): 2,	("893", "Vie", 19.5): 2,	("893", "Sab", 19.5): 2,	("893", "Dom", 17): 2,
    ("894", "Lun", 20.5): 2,	("894", "Mar", 20.5): 2,	("894", "Mie", 20.5): 2,	("894", "Jue", 20.5): 2,	("894", "Vie", 20.5): 2,	("894", "Sab", 20.5): 2,	("894", "Dom", 19.5): 2,
    ("895", "Lun", 19): 2,	("895", "Mar", 19): 2,	("895", "Mie", 19): 2,	("895", "Jue", 19): 2,	("895", "Vie", 19.5): 2,	("895", "Sab", 19.5): 2,	("895", "Dom", 17.5): 2,
    ("897", "Lun", 20): 2,	("897", "Mar", 20): 2,	("897", "Mie", 20): 2,	("897", "Jue", 20): 2,	("897", "Vie", 20): 2,	("897", "Sab", 20): 2,	("897", "Dom", 17): 2,
    ("898", "Lun", 20): 2,	("898", "Mar", 20): 2,	("898", "Mie", 20): 2,	("898", "Jue", 20): 2,	("898", "Vie", 20.5): 2,	("898", "Sab", 20.5): 2,	("898", "Dom", 20): 2

    }

def generate_hour_slots(stores_to_process):
    """
    Genera los diccionarios de slots de tiempo para un conjunto específico de tiendas.
    """
    hours_per_store_day = {}
    for store in stores_to_process:
        hours_per_store_day[store] = {}
        for day in DAYS:
            start = OPENING_HOURS.get(store, {}).get(day)
            end = CLOSING_HOURS.get(store, {}).get(day)
            hours = []
            if start is not None and end is not None and start < end:
                current = start
                while current < end:
                    hours.append(current)
                    current += 0.5
            hours_per_store_day[store][day] = hours

    unified_hours_per_day = {}
    for day in DAYS:
        all_h = set()
        for store in stores_to_process:
            all_h.update(hours_per_store_day.get(store, {}).get(day, []))
        unified_hours_per_day[day] = sorted(all_h)
        
    return hours_per_store_day, unified_hours_per_day

# Costos por hora (se dividirán por 2 para slots de media hora)
def generate_cost_dictionaries(unified_hours_per_day):
    """
    Genera los diccionarios de costos basados en los horarios unificados.
    """
    costs_regular = {
        (d, h): (11647 if 6 <= h < 19 else 15723) if d == "Dom"
        else (6470 if 6 <= h < 19 else 8735)
        for d in DAYS for h in unified_hours_per_day.get(d, [])
    }
    costs_overtime = {
        (d, h): (132640 if 6 <= h < 19 else 165000) if d == "Dom"
        else (80880 if 6 <= h < 19 else 113230)
        for d in DAYS for h in unified_hours_per_day.get(d, [])
    }
    return costs_regular, costs_overtime
# ============================================================================
# CARGA Y PROCESAMIENTO DE DATOS
# ============================================================================
def EMPLOYEES(store):
    return range(EMPLOYEES_PER_STORE[store])
def load_demand_data(csv_file, store, current_push_gap):
    """
    Carga datos de demanda desde archivo CSV y calcula personal requerido
    respetando el límite máximo de empleados en hora pico
    """
    df = pd.read_csv(csv_file)
    max_staff = max(EMPLOYEES_PER_STORE[store], MIN_EMPLOYEES_PEAK_HOUR.get(store, 0))
    peak_limit = MIN_EMPLOYEES_PEAK_HOUR.get(store, max_staff) # ← nuevo
    # Convertir hora de formato HH:MM a decimal
    def time_to_decimal(time_str):
        parts = time_str.strip().split(':')
        hours = int(parts[0])
        minutes = int(parts[1])
        return hours + minutes / 60.0
   
    df['hora_decimal'] = df['hora'].apply(time_to_decimal)
   
    # Mapear día de semana
    day_mapping = {1: "Lun", 2: "Mar", 3: "Mie", 4: "Jue", 5: "Vie", 6: "Sab", 7: "Dom"}
    df['dia_nombre'] = df['Dia_semana'].map(day_mapping)
   
    # Calcular máximo de facturas para regla de tres
    max_facturas = df['Suma de cantidad_facturas'].max()
   
    # Calcular personal requerido base (regla de tres con redondeo hacia arriba)
    df['personal_base'] = df['Suma de cantidad_facturas'].apply(
        lambda x: max(MIN_EMPLOYEES_ALL_TIMES[store], min(max_staff, math.floor(x / max_facturas * max_staff + current_push_gap)))
        #math.ceil(x / max_facturas * max_staff)
        )
   
    # Aplicar límite superior de hora pico
    df['personal_requerido'] = df['personal_base'].apply(
        lambda x: min(x, peak_limit)
    )
   
    # Aplicar overrides (tienen prioridad sobre todo)
    # Nota: los overrides pueden superar el peak_limit si así lo deseas
    # Si NO quieres que los overrides superen el peak_limit, quita el .get() y usa solo min()
    for (s, d, h), req in MIN_STAFF_OVERRIDE.items():
        if s == store:
            mask = (df['dia_nombre'] == d) & (df['hora_decimal'] == h)
            if mask.any():
                # Aplicamos elemento por elemento
                df.loc[mask, 'personal_requerido'] = df.loc[mask, 'personal_requerido'].combine(
                    req, max # max entre el valor existente y el override
                )
   
    # Límite final: nunca más que el número total de empleados de la tienda
    df['personal_requerido'] = df['personal_requerido'].clip(upper=max_staff)
   
    # Crear diccionario de demanda
    demand = {}
    for _, row in df.iterrows():
        key = (row['dia_nombre'], row['hora_decimal'])
        demand[key] = int(row['personal_requerido'])
    print(demand)
    return demand



# ============================================================================
# FUNCIÓN DE LOOP
# ============================================================================

def run_optimization(STORES, HAS_SUPERNUMERARY, current_push_gap, HOURS_PER_STORE_DAY, UNIFIED_HOURS_PER_DAY, COSTS_REGULAR, COSTS_OVERTIME):
    """
    Esta función encapsula toda la lógica de optimización para un conjunto
    de tiendas y un valor de push_gap específicos.
    Retorna True si la solución es factible/óptima, False en caso contrario.
    """
    # Cargar demanda para las tiendas
    print("Cargando datos de demanda...")
    DEMAND = {store: load_demand_data(f"{store}.csv", store, current_push_gap) for store in STORES}
    print("Datos cargados exitosamente.")

    # ============================================================================
    # CREACIÓN DEL MODELO
    # ============================================================================
    print("\nCreando modelo de optimización...")
    model = cp_model.CpModel()
    # ============================================================================
    # VARIABLES DE DECISIÓN
    # ============================================================================
    # Variables para empleados regulares de cada tienda
    regular = {}
    overtime = {}
    for store in STORES:
        regular[store] = {}
        overtime[store] = {}
        for emp in EMPLOYEES(store):
            regular[store][emp] = {}
            overtime[store][emp] = {}
            for day in DAYS:
                regular[store][emp][day] = {}
                overtime[store][emp][day] = {}
                for hour in HOURS_PER_STORE_DAY[store][day]:
                    regular[store][emp][day][hour] = model.NewBoolVar(
                        f'regular_{store}_emp{emp}_{day}_{hour}'
                    )
                    overtime[store][emp][day][hour] = model.NewBoolVar(
                        f'overtime_{store}_emp{emp}_{day}_{hour}'
                    )
    # Variables auxiliares para identificar días de trabajo
    works_day = {}
    for store in STORES:
        works_day[store] = {}
        for emp in EMPLOYEES(store):
            works_day[store][emp] = {}
            for day in DAYS:
                works_day[store][emp][day] = model.NewBoolVar(
                    f'works_{store}_emp{emp}_{day}'
                )
    # Variables para identificar inicio temprano
    early_start = {}
    for store in STORES:
        early_start[store] = {}
        for emp in EMPLOYEES(store):
            early_start[store][emp] = {}
            for day in DAYS:
                early_start[store][emp][day] = model.NewBoolVar(
                    f'early_start_{store}_emp{emp}_{day}'
                )
    if HAS_SUPERNUMERARY:
        # Variables para supernumerario
        regular_sup = {}
        overtime_sup = {}
        for store in STORES:
            regular_sup[store] = {}
            overtime_sup[store] = {}
            for day in DAYS:
                regular_sup[store][day] = {}
                overtime_sup[store][day] = {}
                for hour in HOURS_PER_STORE_DAY[store][day]:
                    regular_sup[store][day][hour] = model.NewBoolVar(
                        f'regular_sup_{store}_{day}_{hour}'
                    )
                    overtime_sup[store][day][hour] = model.NewBoolVar(
                        f'overtime_sup_{store}_{day}_{hour}'
                    )
        # Variable para asignación de tienda del supernumerario por día
        supernumerary_store = {}
        for day in DAYS:
            supernumerary_store[day] = {}
            for store in STORES:
                supernumerary_store[day][store] = model.NewBoolVar(
                    f'sup_assigned_{day}_{store}'
                )
        # Variables auxiliares para supernumerario
        works_day_sup = {}
        for day in DAYS:
            works_day_sup[day] = model.NewBoolVar(f'works_sup_{day}')
        early_start_sup = {}
        for day in DAYS:
            early_start_sup[day] = model.NewBoolVar(f'early_start_sup_{day}')


    # Variables para Sabatino → solo se crean para las tiendas que tienen configuración válida
    sabatino_regular = {}
    sabatino_works_day = {}
    early_start_sab = {}

    if store in STORES_WITH_SABATINO:
        
        sabatino_regular[store] = {}
        sabatino_works_day[store] = {}
        early_start_sab[store] = {}
        
        for day in DAYS:
            sabatino_works_day[store][day] = model.NewBoolVar(f'sabatino_works_{store}_{day}')
            early_start_sab[store][day] = model.NewBoolVar(f'early_start_sab_{store}_{day}')
            
            sabatino_regular[store][day] = {}
            for hour in HOURS_PER_STORE_DAY[store][day]:
                sabatino_regular[store][day][hour] = model.NewBoolVar(
                    f'sabatino_regular_{store}_{day}_{hour}'
                )

    # ============================================================================
    # FUNCIÓN OBJETIVO
    # ============================================================================
    def define_objective(COSTS_REGULAR, COSTS_OVERTIME):
        """
        Define la función objetivo: minimizar el costo total de nómina
        """
        objective_terms = []
    
        # Costos de empleados regulares
        for store in STORES:
            for emp in EMPLOYEES(store):
                for day in DAYS:
                    for hour in HOURS_PER_STORE_DAY[store][day]:
                        # Costo regular (dividido por 2 para media hora)
                        cost_reg = COSTS_REGULAR[(day, hour)] // 2
                        objective_terms.append(regular[store][emp][day][hour] * cost_reg)
                    
                        # Costo overtime (dividido por 2 para media hora)
                        cost_ot = COSTS_OVERTIME[(day, hour)] // 2
                        objective_terms.append(overtime[store][emp][day][hour] * cost_ot)
    
        if HAS_SUPERNUMERARY:
            # Costos del supernumerario
            for store in STORES:
                for day in DAYS:
                    for hour in HOURS_PER_STORE_DAY[store][day]:
                        cost_reg = COSTS_REGULAR[(day, hour)] // 2
                        objective_terms.append(regular_sup[store][day][hour] * cost_reg)
                    
                        cost_ot = COSTS_OVERTIME[(day, hour)] // 2
                        objective_terms.append(overtime_sup[store][day][hour] * cost_ot)
        
        if store in STORES_WITH_SABATINO:
            for store in STORES:
                for day in DAYS:
                    for hour in HOURS_PER_STORE_DAY[store][day]:
                        cost_reg = COSTS_REGULAR[(day, hour)] // 2
                        objective_terms.append(sabatino_regular[store][day][hour] * cost_reg)

        model.Minimize(sum(objective_terms))
        print("Función objetivo definida.")
    # ============================================================================
    # RESTRICCIONES
    # ============================================================================
    def add_staffing_requirements():
        """
        RESTRICCIÓN 1: Satisfacer la necesidad de personal en cada slot
        """
        for store in STORES:
            for day in DAYS:
                for hour in HOURS_PER_STORE_DAY[store][day]:
                    required = DEMAND[store].get((day, hour), 1)
                    if (store, day, hour) in MIN_STAFF_OVERRIDE:
                        required = max(required, MIN_STAFF_OVERRIDE[(store, day, hour)])
                
                    # Contar empleados regulares trabajando
                    employees_working = []
                    for emp in EMPLOYEES(store):
                        employees_working.append(regular[store][emp][day][hour])
                        employees_working.append(overtime[store][emp][day][hour])
                
                    if HAS_SUPERNUMERARY:
                        # Agregar supernumerario si está asignado a esta tienda
                        employees_working.append(regular_sup[store][day][hour])
                        employees_working.append(overtime_sup[store][day][hour])

                    if store in STORES_WITH_SABATINO:
                        employees_working.append(sabatino_regular[store][day][hour])
                    model.Add(sum(employees_working) >= required)
    
        print("Restricción 1: Requerimientos de personal agregada.")
    def add_no_simultaneous_regular_overtime():
        """
        RESTRICCIÓN 2: Un empleado no puede trabajar simultáneamente
        hora regular y hora extra en el mismo slot
        """
        # Empleados regulares
        for store in STORES:
            for emp in EMPLOYEES(store):
                for day in DAYS:
                    for hour in HOURS_PER_STORE_DAY[store][day]:
                        model.Add(
                            regular[store][emp][day][hour] +
                            overtime[store][emp][day][hour] <= 1
                        )
    
        if HAS_SUPERNUMERARY:
            # Supernumerario
            for store in STORES:
                for day in DAYS:
                    for hour in HOURS_PER_STORE_DAY[store][day]:
                        model.Add(
                            regular_sup[store][day][hour] +
                            overtime_sup[store][day][hour] <= 1
                        )
    
        print("Restricción 2: No simultaneidad regular/overtime agregada.")
    def add_rest_day_constraints():
        """
        RESTRICCIÓN 3: Días de descanso según configuración permitida
        """
        # ── Empleados regulares ───────────────────────────────────────────────
        for store in STORES:
            allowed_rest_for_store = ALLOWED_REST_DAYS.get(store, [])
        
            open_days = [d for d in DAYS if HOURS_PER_STORE_DAY[store][d]]
            possible_rest_days = [d for d in allowed_rest_for_store if d in open_days]
        
            required_rests = 1 if possible_rest_days else 0
        
            for emp in EMPLOYEES(store):
                rest_days_vars = []
            
                for day in possible_rest_days:
                    rests_this_day = model.NewBoolVar(f'rest_{store}_emp{emp}_{day}')
                
                    total_work = sum(
                        regular[store][emp][day][h] + overtime[store][emp][day][h]
                        for h in HOURS_PER_STORE_DAY[store][day]
                    )
                
                    model.Add(total_work == 0).OnlyEnforceIf(rests_this_day)
                    model.Add(total_work >= 1).OnlyEnforceIf(rests_this_day.Not())
                
                    rest_days_vars.append(rests_this_day)
            
                # Deben descansar exactamente 1 día permitido (si existen)
                model.Add(sum(rest_days_vars) == required_rests)
            
                # Prohibido descansar en días NO permitidos
                forbidden_days = [d for d in open_days if d not in allowed_rest_for_store]
                for day in forbidden_days:
                    total_work = sum(
                        regular[store][emp][day][h] + overtime[store][emp][day][h]
                        for h in HOURS_PER_STORE_DAY[store][day]
                    )
                    model.Add(total_work >= 1) # debe trabajar sí o sí
        if HAS_SUPERNUMERARY:
            # ── SUPERNUMERARIO ─────────────────────────────────────────────────────
            allowed_rest_sup = ALLOWED_REST_DAYS.get("Supernumerario", [])
    
            # Días en los que NO puede descansar → debe trabajar al menos algo
            must_work_days = [day for day in DAYS if day not in allowed_rest_sup]
            
            for day in must_work_days:
                total_work_sup_day = []
                for store in STORES:
                    for hour in HOURS_PER_STORE_DAY[store].get(day, []):
                        total_work_sup_day.append(regular_sup[store][day][hour])
                        total_work_sup_day.append(overtime_sup[store][day][hour])
            
                # En estos días → debe trabajar al menos 1 slot
                if total_work_sup_day: # solo si hay horarios ese día
                    model.Add(sum(total_work_sup_day) >= 1)
    
            # Nota: en los días que SÍ están en allowed_rest_sup
            # puede trabajar o no trabajar (se deja libre, la restricción de 88h semanales
            # se encarga de que en general trabaje bastante)
            # Agregar restricción de al menos un día de descanso para supernumerario
            rest_days_sup_vars = []
            possible_rest_days_sup = [d for d in allowed_rest_sup if UNIFIED_HOURS_PER_DAY[d]]
            for day in possible_rest_days_sup:
                rests_this_day_sup = model.NewBoolVar(f'rest_sup_{day}')
                total_work_sup_day = []
                for store in STORES:
                    for hour in HOURS_PER_STORE_DAY[store].get(day, []):
                        total_work_sup_day.append(regular_sup[store][day][hour])
                        total_work_sup_day.append(overtime_sup[store][day][hour])
                model.Add(sum(total_work_sup_day) == 0).OnlyEnforceIf(rests_this_day_sup)
                model.Add(sum(total_work_sup_day) >= 1).OnlyEnforceIf(rests_this_day_sup.Not())
                rest_days_sup_vars.append(rests_this_day_sup)
            if possible_rest_days_sup:
                model.Add(sum(rest_days_sup_vars) >= 1)



                
    
        print("Restricción 3: Días de descanso configurables (versión corregida).")
    def add_weekly_regular_hours():
        """
        RESTRICCIÓN 4: Cada empleado debe trabajar exactamente 44 horas regulares
        (88 slots de media hora) a la semana
        """
        # Empleados regulares
        for store in STORES:
            for emp in EMPLOYEES(store):
                weekly_regular = []
                for day in DAYS:
                    for hour in HOURS_PER_STORE_DAY[store][day]:
                        weekly_regular.append(regular[store][emp][day][hour])
            
                model.Add(sum(weekly_regular) == 88)
    
        if HAS_SUPERNUMERARY:
            # Supernumerario
            weekly_regular_sup = []
            for store in STORES:
                for day in DAYS:
                    for hour in HOURS_PER_STORE_DAY[store][day]:
                        weekly_regular_sup.append(regular_sup[store][day][hour])
    
            model.Add(sum(weekly_regular_sup) == 88)
    
        print("Restricción 4: 44 horas regulares semanales agregada.")
    def add_supernumerary_one_store_per_day():
        """
        RESTRICCIÓN 5: El supernumerario solo puede trabajar en una tienda por día
        """
        if HAS_SUPERNUMERARY:
            for day in DAYS:
                # El supernumerario puede estar asignado a máximo una tienda por día
                model.Add(sum(supernumerary_store[day][store] for store in STORES) <= 1)
            
                # Si trabaja en un slot de una tienda, debe estar asignado a esa tienda
                for store in STORES:
                    for hour in HOURS_PER_STORE_DAY[store][day]:
                        # Si trabaja (regular u overtime) en esta tienda, debe estar asignado
                        model.Add(
                            regular_sup[store][day][hour] + overtime_sup[store][day][hour] <=
                            supernumerary_store[day][store]
                        )
            
                # Si está asignado a una tienda, debe trabajar al menos un slot
                for store in STORES:
                    total_work_in_store = []
                    for hour in HOURS_PER_STORE_DAY[store][day]:
                        total_work_in_store.append(regular_sup[store][day][hour])
                        total_work_in_store.append(overtime_sup[store][day][hour])
            
                    # Si está asignado, trabaja al menos 1 slot
                    model.Add(sum(total_work_in_store) >= 1).OnlyEnforceIf(
                        supernumerary_store[day][store]
                    )
                    # Si no está asignado, no trabaja ningún slot
                    model.Add(sum(total_work_in_store) == 0).OnlyEnforceIf(
                        supernumerary_store[day][store].Not()
                    )
    
            print("Restricción 5: Supernumerario en una tienda por día agregada.")
    def add_minimum_daily_hours():
        """
        RESTRICCIÓN 6: Si un empleado tiene trabajo asignado un día,
        debe trabajar como mínimo 6 horas regulares (12 slots)
        """
        # Empleados regulares
        for store in STORES:
            for emp in EMPLOYEES(store):
                for day in DAYS:
                    daily_regular = []
                    for hour in HOURS_PER_STORE_DAY[store][day]:
                        daily_regular.append(regular[store][emp][day][hour])
                
                    # Definir si trabaja este día
                    total_work = []
                    for hour in HOURS_PER_STORE_DAY[store][day]:
                        total_work.append(regular[store][emp][day][hour])
                        total_work.append(overtime[store][emp][day][hour])
                
                    # works_day = 1 si trabaja al menos un slot
                    model.Add(sum(total_work) >= 1).OnlyEnforceIf(works_day[store][emp][day])
                    model.Add(sum(total_work) == 0).OnlyEnforceIf(works_day[store][emp][day].Not())
                
                    # Si trabaja, debe tener al menos 12 slots regulares
                    model.Add(sum(daily_regular) >= 12).OnlyEnforceIf(works_day[store][emp][day])
    
        if HAS_SUPERNUMERARY:
            # Supernumerario
            for day in DAYS:
                daily_regular_sup = []
                total_work_sup = []
                for store in STORES:
                    for hour in HOURS_PER_STORE_DAY[store][day]:
                        daily_regular_sup.append(regular_sup[store][day][hour])
                        total_work_sup.append(regular_sup[store][day][hour])
                        total_work_sup.append(overtime_sup[store][day][hour])
        
                # works_day_sup = 1 si trabaja al menos un slot
                model.Add(sum(total_work_sup) >= 1).OnlyEnforceIf(works_day_sup[day])
                model.Add(sum(total_work_sup) == 0).OnlyEnforceIf(works_day_sup[day].Not())
        
                # Si trabaja, debe tener al menos 12 slots regulares
                model.Add(sum(daily_regular_sup) >= 12).OnlyEnforceIf(works_day_sup[day])
    
        print("Restricción 6: Mínimo 6 horas regulares diarias agregada.")
    def add_maximum_daily_regular_hours():
        """
        RESTRICCIÓN 7: Un empleado puede trabajar como máximo 9 horas regulares
        en un día (18 slots)
        """
        # Empleados regulares
        for store in STORES:
            for emp in EMPLOYEES(store):
                for day in DAYS:
                    daily_regular = []
                    for hour in HOURS_PER_STORE_DAY[store][day]:
                        daily_regular.append(regular[store][emp][day][hour])
                
                    model.Add(sum(daily_regular) <= 18)
    
        if HAS_SUPERNUMERARY:
            # Supernumerario
            for day in DAYS:
                daily_regular_sup = []
                for store in STORES:
                    for hour in HOURS_PER_STORE_DAY[store][day]:
                        daily_regular_sup.append(regular_sup[store][day][hour])
        
                model.Add(sum(daily_regular_sup) <= 18)
    
        print("Restricción 7: Máximo 9 horas regulares diarias agregada.")
    def add_maximum_daily_total_hours():
        """
        RESTRICCIÓN 8: Un empleado puede trabajar como máximo 10 horas
        (regulares o extras) en un día (20 slots)
        """
        # Empleados regulares
        for store in STORES:
            for emp in EMPLOYEES(store):
                for day in DAYS:
                    daily_total = []
                    for hour in HOURS_PER_STORE_DAY[store][day]:
                        daily_total.append(regular[store][emp][day][hour])
                        daily_total.append(overtime[store][emp][day][hour])
                
                    model.Add(sum(daily_total) <= 20)
    
        if HAS_SUPERNUMERARY:
            # Supernumerario
            for day in DAYS:
                daily_total_sup = []
                for store in STORES:
                    for hour in HOURS_PER_STORE_DAY[store][day]:
                        daily_total_sup.append(regular_sup[store][day][hour])
                        daily_total_sup.append(overtime_sup[store][day][hour])
        
                model.Add(sum(daily_total_sup) <= 20)
    
        print("Restricción 8: Máximo 10 horas totales diarias agregada.")
    def add_maximum_one_rest_break():
        """
        RESTRICCIÓN 9: Cada empleado debe descansar como máximo 1 vez en el día
        (máximo 2 bloques de trabajo = máximo 1 bloque de descanso)
        """
        # Empleados regulares
        for store in STORES:
            for emp in EMPLOYEES(store):
                for day in DAYS:
                    hours_list = HOURS_PER_STORE_DAY[store][day]
                    if not hours_list:
                        continue
                
                    # Identificar si trabaja en cada slot
                    is_working = []
                    for hour in hours_list:
                        working = model.NewBoolVar(f'working_{store}_emp{emp}_{day}_{hour}')
                        model.Add(regular[store][emp][day][hour] + overtime[store][emp][day][hour] >= 1).OnlyEnforceIf(working)
                        model.Add(regular[store][emp][day][hour] + overtime[store][emp][day][hour] == 0).OnlyEnforceIf(working.Not())
                        is_working.append(working)
                
                    # Contar inicios de bloques de trabajo
                    block_starts = []
                    for i in range(len(is_working)):
                        start = model.NewBoolVar(f'start_{store}_emp{emp}_{day}_{i}')
                        if i == 0:
                            model.Add(start == is_working[i])
                        else:
                            model.AddBoolAnd([is_working[i], is_working[i-1].Not()]).OnlyEnforceIf(start)
                            model.AddBoolOr([is_working[i].Not(), is_working[i-1]]).OnlyEnforceIf(start.Not())
                        block_starts.append(start)
                
                    # Máximo 2 bloques de trabajo
                    model.Add(sum(block_starts) <= 2)
    
        if HAS_SUPERNUMERARY:
            # Supernumerario
            for day in DAYS:
                hours_list = UNIFIED_HOURS_PER_DAY[day]
                if not hours_list:
                    continue
            
                is_working_sup = []
                for hour in hours_list:
                    working = model.NewBoolVar(f'working_sup_{day}_{hour}')
                    total_work = []
                    for store in STORES:
                        if hour in HOURS_PER_STORE_DAY[store][day]:
                            total_work.append(regular_sup[store][day][hour])
                            total_work.append(overtime_sup[store][day][hour])
                    model.Add(sum(total_work) >= 1).OnlyEnforceIf(working)
                    model.Add(sum(total_work) == 0).OnlyEnforceIf(working.Not())
                    is_working_sup.append(working)
            
                block_starts_sup = []
                for i in range(len(is_working_sup)):
                    start = model.NewBoolVar(f'start_sup_{day}_{i}')
                    if i == 0:
                        model.Add(start == is_working_sup[i])
                    else:
                        model.AddBoolAnd([is_working_sup[i], is_working_sup[i-1].Not()]).OnlyEnforceIf(start)
                        model.AddBoolOr([is_working_sup[i].Not(), is_working_sup[i-1]]).OnlyEnforceIf(start.Not())
                    block_starts_sup.append(start)
            
                model.Add(sum(block_starts_sup) <= 2)

        # Sabatino: máximo un descanso por día (mismo que empleados regulares)
        if store in STORES_WITH_SABATINO:
            for day in DAYS:
                hours_list = HOURS_PER_STORE_DAY[store][day]
                if not hours_list: continue
                
                is_working = []
            for hour in hours_list:
                working = model.NewBoolVar(f'working_sab_{store}_{day}_{hour}')
                model.Add(sabatino_regular[store][day][hour] == 1).OnlyEnforceIf(working)
                model.Add(sabatino_regular[store][day][hour] == 0).OnlyEnforceIf(working.Not())
                is_working.append(working)
            
            block_starts = []
            for i in range(len(is_working)):
                start = model.NewBoolVar(f'start_sab_{store}_{day}_{i}')
                if i == 0:
                    model.Add(start == is_working[i])
                else:
                    model.AddBoolAnd([is_working[i], is_working[i-1].Not()]).OnlyEnforceIf(start)
                    model.AddBoolOr([is_working[i].Not(), is_working[i-1]]).OnlyEnforceIf(start.Not())
                block_starts.append(start)
            
            model.Add(sum(block_starts) <= 2)
    
        print("Restricción 9: Máximo un descanso por día agregada (permitiendo inicio tarde).")
    def add_early_start_identification():
        """
        RESTRICCIÓN 10: Identificar si un turno empieza temprano (≤ 11.5)
        """
        # Empleados regulares
        for store in STORES:
            for emp in EMPLOYEES(store):
                for day in DAYS:
                    hours_list = HOURS_PER_STORE_DAY[store][day]
                
                    # Encontrar slots tempranos (≤ 11.5)
                    early_slots = [h for h in hours_list if h <= 11.5]
                
                    if not early_slots:
                        # No hay slots tempranos, no puede empezar temprano
                        model.Add(early_start[store][emp][day] == 0)
                        continue
                
                    # early_start = 1 si trabaja en algún slot temprano
                    works_early = []
                    for hour in early_slots:
                        works_early.append(regular[store][emp][day][hour])
                        works_early.append(overtime[store][emp][day][hour])
                
                    model.Add(sum(works_early) >= 1).OnlyEnforceIf(early_start[store][emp][day])
                    model.Add(sum(works_early) == 0).OnlyEnforceIf(early_start[store][emp][day].Not())
    
        if HAS_SUPERNUMERARY:
            # Supernumerario
            for day in DAYS:
                works_early_sup = []
                for store in STORES:
                    early_slots = [h for h in HOURS_PER_STORE_DAY[store][day] if h <= 11.5]
                    for hour in early_slots:
                        works_early_sup.append(regular_sup[store][day][hour])
                        works_early_sup.append(overtime_sup[store][day][hour])
        
                if not works_early_sup:
                    model.Add(early_start_sup[day] == 0)
                    continue
        
                model.Add(sum(works_early_sup) >= 1).OnlyEnforceIf(early_start_sup[day])
                model.Add(sum(works_early_sup) == 0).OnlyEnforceIf(early_start_sup[day].Not())

        # Identificación de inicio temprano para Sabatino
        if store in STORES_WITH_SABATINO:
            for day in DAYS:
                hours_list = HOURS_PER_STORE_DAY[store][day]
                early_slots = [h for h in hours_list if h <= 11.5]
                
                if not early_slots:
                    model.Add(early_start_sab[store][day] == 0)
                    continue
            
                works_early = [sabatino_regular[store][day][hour] for hour in early_slots]
                model.Add(sum(works_early) >= 1).OnlyEnforceIf(early_start_sab[store][day])
                model.Add(sum(works_early) == 0).OnlyEnforceIf(early_start_sab[store][day].Not())
        
        print("Restricción 10: Identificación de inicio temprano agregada.")
    def add_early_start_rest_duration():
        """
        RESTRICCIÓN 11: Si un empleado inicia temprano, el bloque de descanso
        debe durar entre 1 y 4 slots (debe tener descanso)
        """
        # Empleados regulares
        for store in STORES:
            for emp in EMPLOYEES(store):
                for day in DAYS:
                    hours_list = HOURS_PER_STORE_DAY[store][day]
                    if not hours_list: continue
                
                    applies = model.NewBoolVar(f'early_rest_dur_applies_{store}_emp{emp}_{day}')
                    model.AddBoolAnd([early_start[store][emp][day], works_day[store][emp][day]]).OnlyEnforceIf(applies)
                    model.AddBoolOr([early_start[store][emp][day].Not(), works_day[store][emp][day].Not()]).OnlyEnforceIf(applies.Not())
                
                    # Identificar slots de descanso (entre trabajo)
                    is_working = []
                    for hour in hours_list:
                        w = model.NewBoolVar(f'w_dur_{store}_emp{emp}_{day}_{hour}')
                        model.Add(regular[store][emp][day][hour] + overtime[store][emp][day][hour] >= 1).OnlyEnforceIf(w)
                        model.Add(regular[store][emp][day][hour] + overtime[store][emp][day][hour] == 0).OnlyEnforceIf(w.Not())
                        is_working.append(w)
                
                    has_worked = []
                    for i in range(len(is_working)):
                        hw = model.NewBoolVar(f'hw_dur_{store}_emp{emp}_{day}_{i}')
                        if i == 0:
                            model.Add(hw == is_working[i])
                        else:
                            model.AddBoolOr([is_working[i], has_worked[i-1]]).OnlyEnforceIf(hw)
                            model.AddBoolAnd([is_working[i].Not(), has_worked[i-1].Not()]).OnlyEnforceIf(hw.Not())
                        has_worked.append(hw)
                
                    will_work = [None] * len(is_working)
                    for i in range(len(is_working)-1, -1, -1):
                        ww = model.NewBoolVar(f'ww_dur_{store}_emp{emp}_{day}_{i}')
                        if i == len(is_working)-1:
                            model.Add(ww == is_working[i])
                        else:
                            model.AddBoolOr([is_working[i], will_work[i+1]]).OnlyEnforceIf(ww)
                            model.AddBoolAnd([is_working[i].Not(), will_work[i+1].Not()]).OnlyEnforceIf(ww.Not())
                        will_work[i] = ww
                
                    rest_slots = []
                    for i in range(len(is_working)):
                        rs = model.NewBoolVar(f'rs_dur_{store}_emp{emp}_{day}_{i}')
                        if i == 0 or i == len(is_working)-1:
                            model.Add(rs == 0)
                        else:
                            model.AddBoolAnd([is_working[i].Not(), has_worked[i-1], will_work[i+1]]).OnlyEnforceIf(rs)
                            model.AddBoolOr([is_working[i], has_worked[i-1].Not(), will_work[i+1].Not()]).OnlyEnforceIf(rs.Not())
                        rest_slots.append(rs)
                
                    model.Add(sum(rest_slots) >= 1).OnlyEnforceIf(applies)
                    model.Add(sum(rest_slots) <= 4).OnlyEnforceIf(applies)
    
        if HAS_SUPERNUMERARY:
            # Supernumerario
            for day in DAYS:
                hours_list = UNIFIED_HOURS_PER_DAY[day]
                if not hours_list: continue
            
                applies_sup = model.NewBoolVar(f'early_rest_dur_applies_sup_{day}')
                model.AddBoolAnd([early_start_sup[day], works_day_sup[day]]).OnlyEnforceIf(applies_sup)
                model.AddBoolOr([early_start_sup[day].Not(), works_day_sup[day].Not()]).OnlyEnforceIf(applies_sup.Not())
            
                is_working_sup = []
                for hour in hours_list:
                    w = model.NewBoolVar(f'w_dur_sup_{day}_{hour}')
                    total_work = []
                    for store in STORES:
                        if hour in HOURS_PER_STORE_DAY[store][day]:
                            total_work.append(regular_sup[store][day][hour])
                            total_work.append(overtime_sup[store][day][hour])
                    model.Add(sum(total_work) >= 1).OnlyEnforceIf(w)
                    model.Add(sum(total_work) == 0).OnlyEnforceIf(w.Not())
                    is_working_sup.append(w)
            
                has_worked_sup = []
                for i in range(len(is_working_sup)):
                    hw = model.NewBoolVar(f'hw_dur_sup_{day}_{i}')
                    if i == 0:
                        model.Add(hw == is_working_sup[i])
                    else:
                        model.AddBoolOr([is_working_sup[i], has_worked_sup[i-1]]).OnlyEnforceIf(hw)
                        model.AddBoolAnd([is_working_sup[i].Not(), has_worked_sup[i-1].Not()]).OnlyEnforceIf(hw.Not())
                    has_worked_sup.append(hw)
            
                will_work_sup = [None] * len(is_working_sup)
                for i in range(len(is_working_sup)-1, -1, -1):
                    ww = model.NewBoolVar(f'ww_dur_sup_{day}_{i}')
                    if i == len(is_working_sup)-1:
                        model.Add(ww == is_working_sup[i])
                    else:
                        model.AddBoolOr([is_working_sup[i], will_work_sup[i+1]]).OnlyEnforceIf(ww)
                        model.AddBoolAnd([is_working_sup[i].Not(), will_work_sup[i+1].Not()]).OnlyEnforceIf(ww.Not())
                    will_work_sup[i] = ww
            
                rest_slots_sup = []
                for i in range(len(is_working_sup)):
                    rs = model.NewBoolVar(f'rs_dur_sup_{day}_{i}')
                    if i == 0 or i == len(is_working_sup)-1:
                        model.Add(rs == 0)
                    else:
                        model.AddBoolAnd([is_working_sup[i].Not(), has_worked_sup[i-1], will_work_sup[i+1]]).OnlyEnforceIf(rs)
                        model.AddBoolOr([is_working_sup[i], has_worked_sup[i-1].Not(), will_work_sup[i+1].Not()]).OnlyEnforceIf(rs.Not())
                    rest_slots_sup.append(rs)
            
                model.Add(sum(rest_slots_sup) >= 1).OnlyEnforceIf(applies_sup)
                model.Add(sum(rest_slots_sup) <= 4).OnlyEnforceIf(applies_sup)

        # Restricción de descanso temprano para Sabatino
        if store in STORES_WITH_SABATINO:
            for day in DAYS:
                hours_list = HOURS_PER_STORE_DAY[store][day]
                if not hours_list: continue
                
                applies = model.NewBoolVar(f'early_rest_dur_applies_sab_{store}_{day}')
                model.AddBoolAnd([
                    early_start_sab[store][day],
                    sabatino_works_day[store][day]
                ]).OnlyEnforceIf(applies)
                
                model.AddBoolOr([
                    early_start_sab[store][day].Not(),
                    sabatino_works_day[store][day].Not()
                ]).OnlyEnforceIf(applies.Not())
                    
                # Detectar si está trabajando en cada slot
                is_working = []
                for hour in hours_list:
                    w = model.NewBoolVar(f'w_dur_sab_{store}_{day}_{hour}')
                    model.Add(sabatino_regular[store][day][hour] == 1).OnlyEnforceIf(w)
                    model.Add(sabatino_regular[store][day][hour] == 0).OnlyEnforceIf(w.Not())
                    is_working.append(w)
                    
                # has_worked: ha trabajado en algún slot anterior o este
                has_worked = []
                for i in range(len(is_working)):
                    hw = model.NewBoolVar(f'hw_dur_sab_{store}_{day}_{i}')
                    if i == 0:
                        model.Add(hw == is_working[i])
                    else:
                        model.AddBoolOr([is_working[i], has_worked[i-1]]).OnlyEnforceIf(hw)
                        model.AddBoolAnd([is_working[i].Not(), has_worked[i-1].Not()]).OnlyEnforceIf(hw.Not())
                    has_worked.append(hw)
                    
                # will_work: trabajará en algún slot posterior o este
                will_work = [None] * len(is_working)
                for i in range(len(is_working)-1, -1, -1):
                    ww = model.NewBoolVar(f'ww_dur_sab_{store}_{day}_{i}')
                    if i == len(is_working)-1:
                        model.Add(ww == is_working[i])
                    else:
                        model.AddBoolOr([is_working[i], will_work[i+1]]).OnlyEnforceIf(ww)
                        model.AddBoolAnd([is_working[i].Not(), will_work[i+1].Not()]).OnlyEnforceIf(ww.Not())
                    will_work[i] = ww
                    
                # Identificar slots de descanso (no al inicio ni al final del día)
                rest_slots = []
                for i in range(len(is_working)):
                    rs = model.NewBoolVar(f'rs_dur_sab_{store}_{day}_{i}')
                    if i == 0 or i == len(is_working)-1:
                        model.Add(rs == 0)
                    else:
                        model.AddBoolAnd([
                            is_working[i].Not(),
                            has_worked[i-1],
                            will_work[i+1]
                        ]).OnlyEnforceIf(rs)
                        
                        model.AddBoolOr([
                            is_working[i],
                            has_worked[i-1].Not(),
                            will_work[i+1].Not()
                        ]).OnlyEnforceIf(rs.Not())
                    rest_slots.append(rs)
                
                # Aplicar: si aplica, descanso entre 1 y 4 slots
                model.Add(sum(rest_slots) >= 1).OnlyEnforceIf(applies)
                model.Add(sum(rest_slots) <= 4).OnlyEnforceIf(applies)  
        print("Restricción 11: Duración descanso inicio temprano agregada (mejorada).")
    def add_early_start_rest_timing():
        """
        RESTRICCIÓN 12: Si un empleado inicia temprano, el bloque de descanso
        debe iniciar entre las 11 y las 13.5
        """
        # Empleados regulares
        for store in STORES:
            for emp in EMPLOYEES(store):
                for day in DAYS:
                    hours_list = HOURS_PER_STORE_DAY[store][day]
                    if not hours_list: continue
                
                    applies = model.NewBoolVar(f'early_timing_applies_{store}_emp{emp}_{day}')
                    model.AddBoolAnd([early_start[store][emp][day], works_day[store][emp][day]]).OnlyEnforceIf(applies)
                    model.AddBoolOr([early_start[store][emp][day].Not(), works_day[store][emp][day].Not()]).OnlyEnforceIf(applies.Not())
                
                    # Identificar inicio del descanso
                    is_working = []
                    for hour in hours_list:
                        w = model.NewBoolVar(f'w_tim_{store}_emp{emp}_{day}_{hour}')
                        model.Add(regular[store][emp][day][hour] + overtime[store][emp][day][hour] >= 1).OnlyEnforceIf(w)
                        model.Add(regular[store][emp][day][hour] + overtime[store][emp][day][hour] == 0).OnlyEnforceIf(w.Not())
                        is_working.append(w)
                
                    has_worked = []
                    for i in range(len(is_working)):
                        hw = model.NewBoolVar(f'hw_tim_{store}_emp{emp}_{day}_{i}')
                        if i == 0:
                            model.Add(hw == is_working[i])
                        else:
                            model.AddBoolOr([is_working[i], has_worked[i-1]]).OnlyEnforceIf(hw)
                            model.AddBoolAnd([is_working[i].Not(), has_worked[i-1].Not()]).OnlyEnforceIf(hw.Not())
                        has_worked.append(hw)
                
                    will_work = [None] * len(is_working)
                    for i in range(len(is_working)-1, -1, -1):
                        ww = model.NewBoolVar(f'ww_tim_{store}_emp{emp}_{day}_{i}')
                        if i == len(is_working)-1:
                            model.Add(ww == is_working[i])
                        else:
                            model.AddBoolOr([is_working[i], will_work[i+1]]).OnlyEnforceIf(ww)
                            model.AddBoolAnd([is_working[i].Not(), will_work[i+1].Not()]).OnlyEnforceIf(ww.Not())
                        will_work[i] = ww
                
                    rest_starts = []
                    for i in range(len(is_working)):
                        rs_start = model.NewBoolVar(f'rs_start_{store}_emp{emp}_{day}_{i}')
                        if i == 0 or i == len(is_working)-1:
                            model.Add(rs_start == 0)
                        else:
                            model.AddBoolAnd([is_working[i].Not(), is_working[i-1], will_work[i+1]]).OnlyEnforceIf(rs_start)
                            model.AddBoolOr([is_working[i], is_working[i-1].Not(), will_work[i+1].Not()]).OnlyEnforceIf(rs_start.Not())
                        rest_starts.append(rs_start)
                
                    # Si aplica, el único inicio de descanso debe estar en el rango [11, 13.5]
                    for i, hour in enumerate(hours_list):
                        if not (11 <= hour <= 13.5):
                            model.Add(rest_starts[i] == 0).OnlyEnforceIf(applies)
    
        if HAS_SUPERNUMERARY:
            # Supernumerario
            for day in DAYS:
                hours_list = UNIFIED_HOURS_PER_DAY[day]
                if not hours_list: continue
            
                applies_sup = model.NewBoolVar(f'early_timing_applies_sup_{day}')
                model.AddBoolAnd([early_start_sup[day], works_day_sup[day]]).OnlyEnforceIf(applies_sup)
                model.AddBoolOr([early_start_sup[day].Not(), works_day_sup[day].Not()]).OnlyEnforceIf(applies_sup.Not())
            
                is_working_sup = []
                for hour in hours_list:
                    w = model.NewBoolVar(f'w_tim_sup_{day}_{hour}')
                    total_work = []
                    for store in STORES:
                        if hour in HOURS_PER_STORE_DAY[store][day]:
                            total_work.append(regular_sup[store][day][hour])
                            total_work.append(overtime_sup[store][day][hour])
                    model.Add(sum(total_work) >= 1).OnlyEnforceIf(w)
                    model.Add(sum(total_work) == 0).OnlyEnforceIf(w.Not())
                    is_working_sup.append(w)
            
                will_work_sup = [None] * len(is_working_sup)
                for i in range(len(is_working_sup)-1, -1, -1):
                    ww = model.NewBoolVar(f'ww_tim_sup_{day}_{i}')
                    if i == len(is_working_sup)-1:
                        model.Add(ww == is_working_sup[i])
                    else:
                        model.AddBoolOr([is_working_sup[i], will_work_sup[i+1]]).OnlyEnforceIf(ww)
                        model.AddBoolAnd([is_working_sup[i].Not(), will_work_sup[i+1].Not()]).OnlyEnforceIf(ww.Not())
                    will_work_sup[i] = ww
            
                rest_starts_sup = []
                for i in range(len(is_working_sup)):
                    rs_start = model.NewBoolVar(f'rs_start_sup_{day}_{i}')
                    if i == 0 or i == len(is_working_sup)-1:
                        model.Add(rs_start == 0)
                    else:
                        model.AddBoolAnd([is_working_sup[i].Not(), is_working_sup[i-1], will_work_sup[i+1]]).OnlyEnforceIf(rs_start)
                        model.AddBoolOr([is_working_sup[i], is_working_sup[i-1].Not(), will_work_sup[i+1].Not()]).OnlyEnforceIf(rs_start.Not())
                    rest_starts_sup.append(rs_start)
            
                for i, hour in enumerate(hours_list):
                    if not (11 <= hour <= 13.5):
                        model.Add(rest_starts_sup[i] == 0).OnlyEnforceIf(applies_sup)
        print("Restricción 12: Timing descanso inicio temprano agregada (mejorada).")
    def add_late_start_rest_duration():
        """
        RESTRICCIÓN 13: Si un empleado NO inicia temprano, el bloque de descanso
        puede durar como máximo 1 slot (0 o 1)
        """
        # Empleados regulares
        for store in STORES:
            for emp in EMPLOYEES(store):
                for day in DAYS:
                    hours_list = HOURS_PER_STORE_DAY[store][day]
                    if not hours_list: continue
                
                    applies = model.NewBoolVar(f'late_rest_applies_{store}_emp{emp}_{day}')
                    model.AddBoolAnd([early_start[store][emp][day].Not(), works_day[store][emp][day]]).OnlyEnforceIf(applies)
                    model.AddBoolOr([early_start[store][emp][day], works_day[store][emp][day].Not()]).OnlyEnforceIf(applies.Not())
                
                    is_working = []
                    for hour in hours_list:
                        w = model.NewBoolVar(f'w_late_{store}_emp{emp}_{day}_{hour}')
                        model.Add(regular[store][emp][day][hour] + overtime[store][emp][day][hour] >= 1).OnlyEnforceIf(w)
                        model.Add(regular[store][emp][day][hour] + overtime[store][emp][day][hour] == 0).OnlyEnforceIf(w.Not())
                        is_working.append(w)
                
                    has_worked = []
                    for i in range(len(is_working)):
                        hw = model.NewBoolVar(f'hw_late_{store}_emp{emp}_{day}_{i}')
                        if i == 0:
                            model.Add(hw == is_working[i])
                        else:
                            model.AddBoolOr([is_working[i], has_worked[i-1]]).OnlyEnforceIf(hw)
                            model.AddBoolAnd([is_working[i].Not(), has_worked[i-1].Not()]).OnlyEnforceIf(hw.Not())
                        has_worked.append(hw)
                
                    will_work = [None] * len(is_working)
                    for i in range(len(is_working)-1, -1, -1):
                        ww = model.NewBoolVar(f'ww_late_{store}_emp{emp}_{day}_{i}')
                        if i == len(is_working)-1:
                            model.Add(ww == is_working[i])
                        else:
                            model.AddBoolOr([is_working[i], will_work[i+1]]).OnlyEnforceIf(ww)
                            model.AddBoolAnd([is_working[i].Not(), will_work[i+1].Not()]).OnlyEnforceIf(ww.Not())
                        will_work[i] = ww
                
                    rest_slots = []
                    for i in range(len(is_working)):
                        rs = model.NewBoolVar(f'rs_late_{store}_emp{emp}_{day}_{i}')
                        if i == 0 or i == len(is_working)-1:
                            model.Add(rs == 0)
                        else:
                            model.AddBoolAnd([is_working[i].Not(), has_worked[i-1], will_work[i+1]]).OnlyEnforceIf(rs)
                            model.AddBoolOr([is_working[i], has_worked[i-1].Not(), will_work[i+1].Not()]).OnlyEnforceIf(rs.Not())
                        rest_slots.append(rs)
                
                    model.Add(sum(rest_slots) <= 1).OnlyEnforceIf(applies)
    
        if HAS_SUPERNUMERARY:
            # Supernumerario
            for day in DAYS:
                hours_list = UNIFIED_HOURS_PER_DAY[day]
                if not hours_list: continue
            
                applies_sup = model.NewBoolVar(f'late_rest_applies_sup_{day}')
                model.AddBoolAnd([early_start_sup[day].Not(), works_day_sup[day]]).OnlyEnforceIf(applies_sup)
                model.AddBoolOr([early_start_sup[day], works_day_sup[day].Not()]).OnlyEnforceIf(applies_sup.Not())
            
                is_working_sup = []
                for hour in hours_list:
                    w = model.NewBoolVar(f'w_late_sup_{day}_{hour}')
                    total_work = []
                    for store in STORES:
                        if hour in HOURS_PER_STORE_DAY[store][day]:
                            total_work.append(regular_sup[store][day][hour])
                            total_work.append(overtime_sup[store][day][hour])
                    model.Add(sum(total_work) >= 1).OnlyEnforceIf(w)
                    model.Add(sum(total_work) == 0).OnlyEnforceIf(w.Not())
                    is_working_sup.append(w)
            
                has_worked_sup = []
                for i in range(len(is_working_sup)):
                    hw = model.NewBoolVar(f'hw_late_sup_{day}_{i}')
                    if i == 0:
                        model.Add(hw == is_working_sup[i])
                    else:
                        model.AddBoolOr([is_working_sup[i], has_worked_sup[i-1]]).OnlyEnforceIf(hw)
                        model.AddBoolAnd([is_working_sup[i].Not(), has_worked_sup[i-1].Not()]).OnlyEnforceIf(hw.Not())
                    has_worked_sup.append(hw)
            
                will_work_sup = [None] * len(is_working_sup)
                for i in range(len(is_working_sup)-1, -1, -1):
                    ww = model.NewBoolVar(f'ww_late_sup_{day}_{i}')
                    if i == len(is_working_sup)-1:
                        model.Add(ww == is_working_sup[i])
                    else:
                        model.AddBoolOr([is_working_sup[i], will_work_sup[i+1]]).OnlyEnforceIf(ww)
                        model.AddBoolAnd([is_working_sup[i].Not(), will_work_sup[i+1].Not()]).OnlyEnforceIf(ww.Not())
                    will_work_sup[i] = ww
            
                rest_slots_sup = []
                for i in range(len(is_working_sup)):
                    rs = model.NewBoolVar(f'rs_late_sup_{day}_{i}')
                    if i == 0 or i == len(is_working_sup)-1:
                        model.Add(rs == 0)
                    else:
                        model.AddBoolAnd([is_working_sup[i].Not(), has_worked_sup[i-1], will_work_sup[i+1]]).OnlyEnforceIf(rs)
                        model.AddBoolOr([is_working_sup[i], has_worked_sup[i-1].Not(), will_work_sup[i+1].Not()]).OnlyEnforceIf(rs.Not())
                    rest_slots_sup.append(rs)
            
                model.Add(sum(rest_slots_sup) <= 1).OnlyEnforceIf(applies_sup)

        
        if store in STORES_WITH_SABATINO:
            for day in DAYS:
                hours_list = HOURS_PER_STORE_DAY[store][day]
                if not hours_list:
                    continue
                
                # Determinar si aplica la restricción (inicio tarde + trabaja el día)
                applies = model.NewBoolVar(f'late_rest_applies_sab_{store}_{day}')
                model.AddBoolAnd([
                    early_start_sab[store][day].Not(),
                    sabatino_works_day[store][day]
                ]).OnlyEnforceIf(applies)
                
                model.AddBoolOr([
                    early_start_sab[store][day],
                    sabatino_works_day[store][day].Not()
                ]).OnlyEnforceIf(applies.Not())
                
                # Identificar si está trabajando en cada slot
                is_working = []
                for hour in hours_list:
                    w = model.NewBoolVar(f'w_late_sab_{store}_{day}_{hour}')
                    model.Add(sabatino_regular[store][day][hour] == 1).OnlyEnforceIf(w)
                    model.Add(sabatino_regular[store][day][hour] == 0).OnlyEnforceIf(w.Not())
                    is_working.append(w)
                
                # has_worked: ha trabajado en algún slot anterior o este
                has_worked = []
                for i in range(len(is_working)):
                    hw = model.NewBoolVar(f'hw_late_sab_{store}_{day}_{i}')
                    if i == 0:
                        model.Add(hw == is_working[i])
                    else:
                        model.AddBoolOr([is_working[i], has_worked[i-1]]).OnlyEnforceIf(hw)
                        model.AddBoolAnd([is_working[i].Not(), has_worked[i-1].Not()]).OnlyEnforceIf(hw.Not())
                    has_worked.append(hw)
                
                # will_work: trabajará en algún slot posterior o este
                will_work = [None] * len(is_working)
                for i in range(len(is_working)-1, -1, -1):
                    ww = model.NewBoolVar(f'ww_late_sab_{store}_{day}_{i}')
                    if i == len(is_working)-1:
                        model.Add(ww == is_working[i])
                    else:
                        model.AddBoolOr([is_working[i], will_work[i+1]]).OnlyEnforceIf(ww)
                        model.AddBoolAnd([is_working[i].Not(), will_work[i+1].Not()]).OnlyEnforceIf(ww.Not())
                    will_work[i] = ww
                
                # Identificar slots que forman parte del descanso (no bordes del día)
                rest_slots = []
                for i in range(len(is_working)):
                    rs = model.NewBoolVar(f'rs_late_sab_{store}_{day}_{i}')
                    if i == 0 or i == len(is_working)-1:
                        model.Add(rs == 0)
                    else:
                        model.AddBoolAnd([
                            is_working[i].Not(),
                            has_worked[i-1],
                            will_work[i+1]
                        ]).OnlyEnforceIf(rs)
                        
                        model.AddBoolOr([
                            is_working[i],
                            has_worked[i-1].Not(),
                            will_work[i+1].Not()
                        ]).OnlyEnforceIf(rs.Not())
                    rest_slots.append(rs)
                
                # Restricción principal para Sabatino: máximo 1 slot de descanso si aplica
                model.Add(sum(rest_slots) <= 1).OnlyEnforceIf(applies)

        print("Restricción 13: Duración descanso inicio tarde agregada (mejorada).")
    def add_min_work_blocks_around_break():
        """
        RESTRICCIÓN 14: Los bloques de trabajo antes y después del descanso
        deben durar al menos 4 slots (2 horas)
        """
        # Empleados regulares
        for store in STORES:
            for emp in EMPLOYEES(store):
                for day in DAYS:
                    hours_list = HOURS_PER_STORE_DAY[store][day]
                    if not hours_list: continue
                
                    is_working = []
                    for hour in hours_list:
                        w = model.NewBoolVar(f'w_minb_{store}_emp{emp}_{day}_{hour}')
                        model.Add(regular[store][emp][day][hour] + overtime[store][emp][day][hour] >= 1).OnlyEnforceIf(w)
                        model.Add(regular[store][emp][day][hour] + overtime[store][emp][day][hour] == 0).OnlyEnforceIf(w.Not())
                        is_working.append(w)
                
                    will_work_later = [None] * len(is_working)
                    for i in range(len(is_working)-1, -1, -1):
                        ww = model.NewBoolVar(f'ww_minb_{store}_emp{emp}_{day}_{i}')
                        if i == len(is_working)-1: model.Add(ww == is_working[i])
                        else:
                            model.AddBoolOr([is_working[i], will_work_later[i+1]]).OnlyEnforceIf(ww)
                            model.AddBoolAnd([is_working[i].Not(), will_work_later[i+1].Not()]).OnlyEnforceIf(ww.Not())
                        will_work_later[i] = ww
                
                    worked_before = []
                    for i in range(len(is_working)):
                        wb = model.NewBoolVar(f'wb_minb_{store}_emp{emp}_{day}_{i}')
                        if i == 0: model.Add(wb == is_working[i])
                        else:
                            model.AddBoolOr([is_working[i], worked_before[i-1]]).OnlyEnforceIf(wb)
                            model.AddBoolAnd([is_working[i].Not(), worked_before[i-1].Not()]).OnlyEnforceIf(wb.Not())
                        worked_before.append(wb)
                    for i in range(len(is_working)):
                        if i > 0 and i < len(is_working) - 1:
                            is_rest_start = model.NewBoolVar(f'rest_start_minb_{store}_emp{emp}_{day}_{i}')
                            model.AddBoolAnd([is_working[i-1], is_working[i].Not(), will_work_later[i+1]]).OnlyEnforceIf(is_rest_start)
                            model.AddBoolOr([is_working[i-1].Not(), is_working[i], will_work_later[i+1].Not()]).OnlyEnforceIf(is_rest_start.Not())
                        
                            if i < 4:
                                model.Add(is_rest_start == 0)
                            else:
                                model.Add(sum(is_working[i-4:i]) == 4).OnlyEnforceIf(is_rest_start)
                        if i > 0:
                            is_rest_end = model.NewBoolVar(f'rest_end_minb_{store}_emp{emp}_{day}_{i}')
                            model.AddBoolAnd([is_working[i-1].Not(), is_working[i], worked_before[i-1]]).OnlyEnforceIf(is_rest_end)
                            model.AddBoolOr([is_working[i-1], is_working[i].Not(), worked_before[i-1].Not()]).OnlyEnforceIf(is_rest_end.Not())
                        
                            if i + 4 > len(is_working):
                                model.Add(is_rest_end == 0)
                            else:
                                model.Add(sum(is_working[i:i+4]) == 4).OnlyEnforceIf(is_rest_end)
        if HAS_SUPERNUMERARY:
            # Supernumerario
            for day in DAYS:
                hours_list = UNIFIED_HOURS_PER_DAY[day]
                if not hours_list: continue
            
                is_working_sup = []
                for hour in hours_list:
                    w = model.NewBoolVar(f'w_minb_sup_{day}_{hour}')
                    total_work = []
                    for store in STORES:
                        if hour in HOURS_PER_STORE_DAY[store][day]:
                            total_work.append(regular_sup[store][day][hour])
                            total_work.append(overtime_sup[store][day][hour])
                    model.Add(sum(total_work) >= 1).OnlyEnforceIf(w)
                    model.Add(sum(total_work) == 0).OnlyEnforceIf(w.Not())
                    is_working_sup.append(w)
            
                will_work_later_sup = [None] * len(is_working_sup)
                for i in range(len(is_working_sup)-1, -1, -1):
                    ww = model.NewBoolVar(f'ww_minb_sup_{day}_{i}')
                    if i == len(is_working_sup)-1: model.Add(ww == is_working_sup[i])
                    else:
                        model.AddBoolOr([is_working_sup[i], will_work_later_sup[i+1]]).OnlyEnforceIf(ww)
                        model.AddBoolAnd([is_working_sup[i].Not(), will_work_later_sup[i+1].Not()]).OnlyEnforceIf(ww.Not())
                    will_work_later_sup[i] = ww
            
                worked_before_sup = []
                for i in range(len(is_working_sup)):
                    wb = model.NewBoolVar(f'wb_minb_sup_{day}_{i}')
                    if i == 0: model.Add(wb == is_working_sup[i])
                    else:
                        model.AddBoolOr([is_working_sup[i], worked_before_sup[i-1]]).OnlyEnforceIf(wb)
                        model.AddBoolAnd([is_working_sup[i].Not(), worked_before_sup[i-1].Not()]).OnlyEnforceIf(wb.Not())
                    worked_before_sup.append(wb)
                for i in range(len(is_working_sup)):
                    if i > 0 and i < len(is_working_sup) - 1:
                        is_rest_start = model.NewBoolVar(f'rest_start_minb_sup_{day}_{i}')
                        model.AddBoolAnd([is_working_sup[i-1], is_working_sup[i].Not(), will_work_later_sup[i+1]]).OnlyEnforceIf(is_rest_start)
                        model.AddBoolOr([is_working_sup[i-1].Not(), is_working_sup[i], will_work_later_sup[i+1].Not()]).OnlyEnforceIf(is_rest_start.Not())
                    
                        if i < 4:
                            model.Add(is_rest_start == 0)
                        else:
                            model.Add(sum(is_working_sup[i-4:i]) == 4).OnlyEnforceIf(is_rest_start)
                    if i > 0:
                        is_rest_end = model.NewBoolVar(f'rest_end_minb_sup_{day}_{i}')
                        model.AddBoolAnd([is_working_sup[i-1].Not(), is_working_sup[i], worked_before_sup[i-1]]).OnlyEnforceIf(is_rest_end)
                        model.AddBoolOr([is_working_sup[i-1], is_working_sup[i].Not(), worked_before_sup[i-1].Not()]).OnlyEnforceIf(is_rest_end.Not())
                    
                        if i + 4 > len(is_working_sup):
                            model.Add(is_rest_end == 0)
                        else:
                            model.Add(sum(is_working_sup[i:i+4]) == 4).OnlyEnforceIf(is_rest_end)

        
        if store in STORES_WITH_SABATINO:
            for day in DAYS:
                hours_list = HOURS_PER_STORE_DAY[store][day]
                if not hours_list:
                    continue
                
                is_working = []
                for hour in hours_list:
                    w = model.NewBoolVar(f'w_minb_sab_{store}_{day}_{hour}')
                    model.Add(sabatino_regular[store][day][hour] == 1).OnlyEnforceIf(w)
                    model.Add(sabatino_regular[store][day][hour] == 0).OnlyEnforceIf(w.Not())
                    is_working.append(w)
                
                will_work_later = [None] * len(is_working)
                for i in range(len(is_working)-1, -1, -1):
                    ww = model.NewBoolVar(f'ww_minb_sab_{store}_{day}_{i}')
                    if i == len(is_working)-1:
                        model.Add(ww == is_working[i])
                    else:
                        model.AddBoolOr([is_working[i], will_work_later[i+1]]).OnlyEnforceIf(ww)
                        model.AddBoolAnd([is_working[i].Not(), will_work_later[i+1].Not()]).OnlyEnforceIf(ww.Not())
                    will_work_later[i] = ww
                
                worked_before = []
                for i in range(len(is_working)):
                    wb = model.NewBoolVar(f'wb_minb_sab_{store}_{day}_{i}')
                    if i == 0:
                        model.Add(wb == is_working[i])
                    else:
                        model.AddBoolOr([is_working[i], worked_before[i-1]]).OnlyEnforceIf(wb)
                        model.AddBoolAnd([is_working[i].Not(), worked_before[i-1].Not()]).OnlyEnforceIf(wb.Not())
                    worked_before.append(wb)
                
                for i in range(len(is_working)):
                    if i > 0 and i < len(is_working) - 1:
                        is_rest_start = model.NewBoolVar(f'rest_start_minb_sab_{store}_{day}_{i}')
                        model.AddBoolAnd([is_working[i-1], is_working[i].Not(), will_work_later[i+1]]).OnlyEnforceIf(is_rest_start)
                        model.AddBoolOr([is_working[i-1].Not(), is_working[i], will_work_later[i+1].Not()]).OnlyEnforceIf(is_rest_start.Not())
                        
                        if i < 4:
                            model.Add(is_rest_start == 0)
                        else:
                            model.Add(sum(is_working[j] for j in range(i-4, i)) == 4).OnlyEnforceIf(is_rest_start)
                    
                    if i > 0:
                        is_rest_end = model.NewBoolVar(f'rest_end_minb_sab_{store}_{day}_{i}')
                        model.AddBoolAnd([is_working[i-1].Not(), is_working[i], worked_before[i-1]]).OnlyEnforceIf(is_rest_end)
                        model.AddBoolOr([is_working[i-1], is_working[i].Not(), worked_before[i-1].Not()]).OnlyEnforceIf(is_rest_end.Not())
                        
                        if i + 4 > len(is_working):
                            model.Add(is_rest_end == 0)
                        else:
                            model.Add(sum(is_working[j] for j in range(i, i+4)) == 4).OnlyEnforceIf(is_rest_end)

        print("Restricción 14: Bloques de trabajo min 4 slots antes/después del descanso agregada.")
    def add_supernumerary_accompaniment():
        """
        RESTRICCIÓN 15: Supernumerario y Sabatino no pueden abrir ni cerrar la tienda estando solos
        ni ser los únicos empleados asignados ese día en la tienda.
        """
        for day in DAYS:
            for store in STORES:
                if not HOURS_PER_STORE_DAY[store][day]:
                    continue
                
                opening = HOURS_PER_STORE_DAY[store][day][0]
                closing = HOURS_PER_STORE_DAY[store][day][-1]
                
                # ────────────────────────────────────────────────────────────────
                # Parte 1: Supernumerario (código original, sin cambios)
                # ────────────────────────────────────────────────────────────────
                if HAS_SUPERNUMERARY:
                    # 1. Si está asignado → al menos un regular trabaja ese día
                    regular_workers = [works_day[store][emp][day] for emp in EMPLOYEES(store)]
                    model.Add(sum(regular_workers) >= 1).OnlyEnforceIf(supernumerary_store[day][store])
                    
                    # 2. Apertura
                    sup_opening = [regular_sup[store][day][opening], overtime_sup[store][day][opening]]
                    sup_working_opening = model.NewBoolVar(f'sup_working_opening_{store}_{day}')
                    model.Add(sum(sup_opening) >= 1).OnlyEnforceIf(sup_working_opening)
                    model.Add(sum(sup_opening) == 0).OnlyEnforceIf(sup_working_opening.Not())
                    
                    regulars_opening = []
                    for emp in EMPLOYEES(store):
                        regulars_opening.append(regular[store][emp][day][opening])
                        regulars_opening.append(overtime[store][emp][day][opening])
                    model.Add(sum(regulars_opening) >= 1).OnlyEnforceIf(sup_working_opening)
                    
                    # 3. Cierre
                    sup_closing = [regular_sup[store][day][closing], overtime_sup[store][day][closing]]
                    sup_working_closing = model.NewBoolVar(f'sup_working_closing_{store}_{day}')
                    model.Add(sum(sup_closing) >= 1).OnlyEnforceIf(sup_working_closing)
                    model.Add(sum(sup_closing) == 0).OnlyEnforceIf(sup_working_closing.Not())
                    
                    regulars_closing = []
                    for emp in EMPLOYEES(store):
                        regulars_closing.append(regular[store][emp][day][closing])
                        regulars_closing.append(overtime[store][emp][day][closing])
                    model.Add(sum(regulars_closing) >= 1).OnlyEnforceIf(sup_working_closing)
                
                # ────────────────────────────────────────────────────────────────
                # Parte 2: Sabatino (versión adaptada y corregida)
                # ────────────────────────────────────────────────────────────────
                # Sabatino no puede abrir ni cerrar solo ni ser el único empleado del día
                if store in STORES_WITH_SABATINO:
                    for day in DAYS:
                        if not HOURS_PER_STORE_DAY[store][day]:
                            continue
                        
                        opening = HOURS_PER_STORE_DAY[store][day][0]
                        closing = HOURS_PER_STORE_DAY[store][day][-1]
                        
                        # Si Sabatino trabaja ese día → al menos un regular también
                        model.Add(sum(works_day[store][emp][day] for emp in EMPLOYEES(store)) >= 1
                                ).OnlyEnforceIf(sabatino_works_day[store][day])
                        
                        # Apertura
                        sab_opening = sabatino_regular[store][day][opening]
                        sab_working_opening = model.NewBoolVar(f'sab_working_opening_{store}_{day}')
                        model.Add(sab_opening == 1).OnlyEnforceIf(sab_working_opening)
                        model.Add(sab_opening == 0).OnlyEnforceIf(sab_working_opening.Not())
                        
                        regulars_opening = [regular[store][emp][day][opening] + overtime[store][emp][day][opening]
                                            for emp in EMPLOYEES(store)]
                        model.Add(sum(regulars_opening) >= 1).OnlyEnforceIf(sab_working_opening)
                        
                        # Cierre (similar)
                        sab_closing = sabatino_regular[store][day][closing]
                        sab_working_closing = model.NewBoolVar(f'sab_working_closing_{store}_{day}')
                        model.Add(sab_closing == 1).OnlyEnforceIf(sab_working_closing)
                        model.Add(sab_closing == 0).OnlyEnforceIf(sab_working_closing.Not())
                        
                        regulars_closing = [regular[store][emp][day][closing] + overtime[store][emp][day][closing]
                                            for emp in EMPLOYEES(store)]
                        model.Add(sum(regulars_closing) >= 1).OnlyEnforceIf(sab_working_closing)

        print("Restricción 15: Acompañamiento para supernumerario y sabatino en apertura/cierre y día completo agregada.")

    def add_overtime_must_be_last():
        """1. Horas extras deben ser las últimas del día (después de extra solo puede haber más extra o fin de jornada)"""
        for store in STORES:
            for emp in EMPLOYEES(store):
                for day in DAYS:
                    hours_list = HOURS_PER_STORE_DAY[store][day]
                    for i in range(len(hours_list)):
                        h1 = hours_list[i]
                        for j in range(i + 1, len(hours_list)):
                            h2 = hours_list[j]
                            model.Add(
                                overtime[store][emp][day][h1] +
                                regular[store][emp][day][h2] <= 1
                            )
        if HAS_SUPERNUMERARY:
            for day in DAYS:
                for store in STORES:
                    hours_list = HOURS_PER_STORE_DAY[store][day]
                    for i in range(len(hours_list)):
                        h1 = hours_list[i]
                        for j in range(i + 1, len(hours_list)):
                            h2 = hours_list[j]
                            model.Add(
                                overtime_sup[store][day][h1] +
                                regular_sup[store][day][h2] <= 1
                            )
        print("Restricción 16: horas extras al final del día agregada.")

    def add_sabatino_constraints():
        """
        Restricciones específicas del Sabatino:
        - Solo trabaja en los días permitidos por tienda
        - Si trabaja un día → debe cumplir con el rango min/max de horas de esa tienda
        - Si no trabaja → 0 horas ese día
        """
        if not STORES_WITH_SABATINO:
            print("No hay tiendas con Sabatino configurado → se omite add_sabatino_constraints()")
            return

        print(f"Aplicando restricciones Sabatino para tiendas: {', '.join(sorted(STORES_WITH_SABATINO))}")

        if store in STORES_WITH_SABATINO:
            # Obtener configuración específica de esta tienda
            allowed_days = SABATINO_WORKING_DAYS.get(store, [])
            min_hours = SABATINO_MIN_HOURS.get(store, 0)
            max_hours = SABATINO_MAX_HOURS.get(store, 0)

            # Validación básica de configuración
            if min_hours <= 0 or max_hours <= 0 or min_hours > max_hours:
                print(f"  Advertencia: Configuración inválida para Sabatino en tienda {store} "
                    f"(min={min_hours}, max={max_hours}) → se ignoran restricciones para esta tienda")
                #continue

            min_slots = int(min_hours * 2)          # slots de 30 min
            max_slots = int(max_hours * 2)

            for day in DAYS:
                hours_list = HOURS_PER_STORE_DAY[store][day]
                if not hours_list:
                    # Día cerrado → no trabaja
                    model.Add(sabatino_works_day[store][day] == 0)
                    continue

                # Suma de slots trabajados por el Sabatino este día en esta tienda
                daily_sab_slots = sum(
                    sabatino_regular[store][day][hour]
                    for hour in hours_list
                )

                if day not in allowed_days:
                    # Día NO permitido → debe ser 0 horas y works_day = False
                    model.Add(daily_sab_slots == 0)
                    model.Add(sabatino_works_day[store][day] == 0)
                else:
                    # Día permitido → puede trabajar o no, pero si trabaja → dentro del rango
                    works = sabatino_works_day[store][day]

                    # Si trabaja → al menos min_slots y máximo max_slots
                    model.Add(daily_sab_slots >= min_slots).OnlyEnforceIf(works)
                    model.Add(daily_sab_slots <= max_slots).OnlyEnforceIf(works)

                    # Si NO trabaja → exactamente 0 slots
                    model.Add(daily_sab_slots == 0).OnlyEnforceIf(works.Not())

        print("Restricciones específicas de Sabatino agregadas correctamente.")
    # ============================================================================
    # APLICAR TODAS LAS RESTRICCIONES
    # ============================================================================
    print("\nAgregando restricciones al modelo...")
    define_objective(COSTS_REGULAR, COSTS_OVERTIME)
    add_staffing_requirements()
    add_no_simultaneous_regular_overtime()
    add_rest_day_constraints()
    add_weekly_regular_hours()
    add_supernumerary_one_store_per_day()
    add_minimum_daily_hours()
    add_maximum_daily_regular_hours()
    add_maximum_daily_total_hours()
    add_maximum_one_rest_break()
    add_early_start_identification()
    add_early_start_rest_duration()
    add_early_start_rest_timing()
    add_late_start_rest_duration()
    add_min_work_blocks_around_break()
    add_supernumerary_accompaniment()
    add_overtime_must_be_last()
    add_sabatino_constraints()
    # ============================================================================
    # RESOLVER EL MODELO
    # ============================================================================
    print("\nResolviendo el modelo...")
    solver = cp_model.CpSolver()
    solver.parameters.max_time_in_seconds = MAX_ALLOWED_OPTIMIZATION_TIME
    solver.parameters.log_search_progress = True
    status = solver.Solve(model)
    print("\n" + "="*80)
    if status == cp_model.OPTIMAL:
        print("SOLUCIÓN ÓPTIMA ENCONTRADA")
    elif status == cp_model.FEASIBLE:
        print("SOLUCIÓN FACTIBLE ENCONTRADA")
    elif status == cp_model.INFEASIBLE:
        print("MODELO INFACTIBLE")
        return False, None
    else:
        print("NO SE ENCONTRÓ SOLUCIÓN")
        return False, None
    print(f"Costo total de nómina: ${solver.ObjectiveValue():,.0f}")
    print("="*80)
    # ============================================================================
    # EXPORTAR RESULTADOS A EXCEL
    # ============================================================================
    print("\nGenerando archivo Excel...")
    wb = Workbook()
    ws = wb.active
    ws.title = "Horarios"
    # Estilos
    header_fill = PatternFill(start_color="366092", end_color="366092", fill_type="solid")
    header_font = Font(bold=True, color="FFFFFF")
    center_align = Alignment(horizontal="center", vertical="center")
    thin_border = Border(
        left=Side(style='thin'),
        right=Side(style='thin'),
        top=Side(style='thin'),
        bottom=Side(style='thin')
    )
    # Agregar costo total al inicio del Excel
    ws.merge_cells(start_row=1, start_column=1, end_row=1, end_column=5)
    cell_cost = ws.cell(row=1, column=1, value=f"Costo Total de Nómina: ${solver.ObjectiveValue():,.0f}")
    cell_cost.font = Font(bold=True, size=14, color="FF0000")
    cell_cost.alignment = Alignment(horizontal="left", vertical="center")
    current_row = 3
    # Obtener todos los slots de tiempo únicos de la semana
    all_hours = sorted(list(set(h for day in UNIFIED_HOURS_PER_DAY for h in UNIFIED_HOURS_PER_DAY[day])))
    # Función para escribir horario de un empleado
    def write_employee_schedule(emp_name, schedule_data, start_row):
        """
        Escribe el horario de un empleado en el Excel
        schedule_data: dict[day][hour] = "R", "X", "R-110", etc.
        """
        row = start_row
    
        # Título del empleado
        ws.merge_cells(start_row=row, start_column=1, end_row=row, end_column=2)
        cell = ws.cell(row=row, column=1, value=emp_name)
        cell.font = Font(bold=True, size=12)
        cell.fill = PatternFill(start_color="D9E1F2", end_color="D9E1F2", fill_type="solid")
        cell.alignment = center_align
        row += 1
    
    
        # Encabezado de horas
        ws.cell(row=row, column=1, value="Día").font = header_font
        ws.cell(row=row, column=1).fill = header_fill
        ws.cell(row=row, column=1).alignment = center_align
        ws.cell(row=row, column=1).border = thin_border
    
        for col_idx, hour in enumerate(all_hours, start=2):
            cell = ws.cell(row=row, column=col_idx, value=hour)
            cell.font = header_font
            cell.fill = header_fill
            cell.alignment = center_align
            cell.border = thin_border
        row += 1
    
        # Datos por día
        for day in DAYS:
            ws.cell(row=row, column=1, value=day).border = thin_border
            ws.cell(row=row, column=1).alignment = center_align
        
            for col_idx, hour in enumerate(all_hours, start=2):
                value = schedule_data.get(day, {}).get(hour, "")
                cell = ws.cell(row=row, column=col_idx, value=value)
                cell.alignment = center_align
                cell.border = thin_border
            
                # Color según tipo
                if "R" in value:
                    cell.fill = PatternFill(start_color="C6EFCE", end_color="C6EFCE", fill_type="solid")
                elif "X" in value:
                    cell.fill = PatternFill(start_color="FFC7CE", end_color="FFC7CE", fill_type="solid")
        
            row += 1
    
        return row + 1 # Espacio entre empleados
    # Escribir horarios de empleados regulares
    for store in STORES:
        for emp in EMPLOYEES(store):
            emp_name = f"Tienda {store} - Empleado {emp + 1}"
            schedule = {}
        
            for day in DAYS:
                schedule[day] = {}
                for hour in HOURS_PER_STORE_DAY[store][day]:
                    if solver.Value(regular[store][emp][day][hour]) == 1:
                        schedule[day][hour] = "R"
                    elif solver.Value(overtime[store][emp][day][hour]) == 1:
                        schedule[day][hour] = "X"
        
            current_row = write_employee_schedule(emp_name, schedule, current_row)
    if HAS_SUPERNUMERARY:
        # Escribir horario del supernumerario
        emp_name = "Supernumerario"
        schedule_sup = {}
        for day in DAYS:
            schedule_sup[day] = {}
            for hour in UNIFIED_HOURS_PER_DAY[day]:
                for store in STORES:
                    if hour in HOURS_PER_STORE_DAY[store][day]:
                        if solver.Value(regular_sup[store][day][hour]) == 1:
                            schedule_sup[day][hour] = f"R-{store}"
                            break
                        elif solver.Value(overtime_sup[store][day][hour]) == 1:
                            schedule_sup[day][hour] = f"X-{store}"
                            break
        current_row = write_employee_schedule(emp_name, schedule_sup, current_row)

    if store in STORES_WITH_SABATINO:
        for store in STORES:
            emp_name = f"Tienda {store} - Sabatino"
            schedule = {}
            for day in DAYS:
                schedule[day] = {}
                for hour in HOURS_PER_STORE_DAY[store][day]:
                    if solver.Value(sabatino_regular[store][day][hour]) == 1:
                        schedule[day][hour] = "S"
            current_row = write_employee_schedule(emp_name, schedule, current_row)

    # Ajustar ancho de columnas
    ws.column_dimensions['A'].width = 15
    # Función auxiliar para convertir número de columna a letra (A, B, ..., Z, AA, AB, ...)
    def get_column_letter(col_idx):
        letter = ''
        while col_idx > 0:
            col_idx, remainder = divmod(col_idx - 1, 26)
            letter = chr(65 + remainder) + letter
        return letter
    # Ajustar ancho para todas las columnas de horas
    for i in range(len(all_hours)):
        col_letter = get_column_letter(i + 2) # +2 porque columna 1 es "A" (día), columna 2 es la primera hora
        ws.column_dimensions[col_letter].width = 8
    # ============================================================================
    # CREAR HOJA ADICIONAL: REPORTE TURNOS DETALLADO
    # ============================================================================
    print("Generando hoja 'Reporte Turnos Detallado'...")
    ws_detail = wb.create_sheet("Reporte Turnos Detallado")
    # Encabezados
    headers = [
        "Tienda", "Empleado", "Día",
        "Hora Ingreso jornada", "Hora Salida descanso", "Hora Ingreso después descanso",
        "Hora Salida jornada", "Horas trabajadas día", "Tiempo descanso (horas)"
    ]
    for col, header in enumerate(headers, 1):
        cell = ws_detail.cell(row=1, column=col, value=header)
        cell.font = Font(bold=True)
        cell.fill = PatternFill(start_color="D9EAD3", end_color="D9EAD3", fill_type="solid")
        cell.alignment = Alignment(horizontal="center", vertical="center", wrap_text=True)
    row = 2
    def time_to_hhmm(decimal_hour):
        """Convierte hora decimal a formato HH:MM"""
        if decimal_hour is None:
            return ""
        hours = int(decimal_hour)
        minutes = int(round((decimal_hour - hours) * 60))
        return f"{hours:02d}:{minutes:02d}"
    # ---------------------------------------
    # Procesar empleados regulares
    # ---------------------------------------
    for store in STORES:
        for emp_idx in EMPLOYEES(store):
            emp_name = f"Empleado {emp_idx + 1}"
        
            for day in DAYS:
                hours_list = HOURS_PER_STORE_DAY[store][day]
                if not hours_list:
                    # Día cerrado → descanso completo
                    ws_detail.append([
                        store,
                        emp_name,
                        day,
                        "Descanso",
                        "", "", "",
                        0,
                        0
                    ])
                    continue
            
                # Recolectar slots trabajados (regular u overtime)
                working_slots = []
                for h in hours_list:
                    if solver.Value(regular[store][emp_idx][day][h]) == 1 or \
                    solver.Value(overtime[store][emp_idx][day][h]) == 1:
                        working_slots.append(h)
            
                if not working_slots:
                    # Descanso completo
                    ws_detail.append([
                        store,
                        emp_name,
                        day,
                        "Descanso",
                        "", "", "",
                        0,
                        0
                    ])
                    continue
            
                # Hay trabajo → calculamos los tiempos
                working_slots.sort()
                first_hour = working_slots[0] # Inicio primer slot
                last_slot_start = working_slots[-1] # Inicio último slot
                last_hour_exit = last_slot_start + 0.5 # ← Salida real: +30 min
            
                # Buscar bloque de descanso (solo uno esperado)
                rest_start = None
                rest_end = None
                for i in range(1, len(working_slots)):
                    prev = working_slots[i-1]
                    curr = working_slots[i]
                    if curr - prev > 0.5:
                        rest_start = prev + 0.5
                        rest_end = curr
                        break
            
                # Cálculo de horas
                horas_trabajadas = len(working_slots) * 0.5
                tiempo_descanso = (rest_end - rest_start) if rest_start and rest_end else 0
            
                fila = [
                    store,
                    emp_name,
                    day,
                    time_to_hhmm(first_hour),
                    time_to_hhmm(rest_start) if rest_start else "",
                    time_to_hhmm(rest_end) if rest_end else "",
                    time_to_hhmm(last_hour_exit), # ← Corrección aplicada aquí
                    round(horas_trabajadas, 1),
                    round(tiempo_descanso, 1) if tiempo_descanso > 0 else ""
                ]
            
                ws_detail.append(fila)

    if store in STORES_WITH_SABATINO:   
        for store in STORES:
            for day in DAYS:
                hours_list = HOURS_PER_STORE_DAY[store][day]
                if not hours_list:
                    continue
                working_slots = [h for h in hours_list if solver.Value(sabatino_regular[store][day][h]) == 1]
                if not working_slots:
                    continue
                working_slots.sort()
                first_hour = working_slots[0]
                last_slot_start = working_slots[-1]
                last_hour_exit = last_slot_start + 0.5
                rest_start = rest_end = None
                for i in range(1, len(working_slots)):
                    if working_slots[i] - working_slots[i-1] > 0.5:
                        rest_start = working_slots[i-1] + 0.5
                        rest_end = working_slots[i]
                        break
                horas_trabajadas = len(working_slots) * 0.5
                tiempo_descanso = (rest_end - rest_start) if rest_start and rest_end else 0
                fila = [
                    store, "Sabatino", day,
                    time_to_hhmm(first_hour),
                    time_to_hhmm(rest_start) if rest_start else "",
                    time_to_hhmm(rest_end) if rest_end else "",
                    time_to_hhmm(last_hour_exit),
                    round(horas_trabajadas, 1),
                    round(tiempo_descanso, 1) if tiempo_descanso > 0 else ""
                ]
                ws_detail.append(fila)

    if HAS_SUPERNUMERARY:
        # ---------------------------------------
        # Supernumerario
        # ---------------------------------------
        sup_name = "Supernumerario"
        for day in DAYS:
            all_working_slots = {} # store → lista de horas trabajadas
    
            for store in STORES:
                hours_list = HOURS_PER_STORE_DAY[store][day]
                working = []
                for h in hours_list:
                    if solver.Value(regular_sup[store][day][h]) == 1 or \
                    solver.Value(overtime_sup[store][day][h]) == 1:
                        working.append(h)
                if working:
                    all_working_slots[store] = sorted(working)
    
            if not all_working_slots:
                # Descanso completo
                ws_detail.append([
                    "—",
                    sup_name,
                    day,
                    "Descanso",
                    "", "", "",
                    0,
                    0
                ])
                continue
    
            # Advertencia si está en más de una tienda (no debería pasar)
            if len(all_working_slots) > 1:
                print(f"Advertencia: Supernumerario en más de una tienda el {day}")
    
            # Tomamos la tienda donde trabaja
            store_sup = list(all_working_slots.keys())[0]
            working_slots = all_working_slots[store_sup]
    
            first_hour = working_slots[0]
            last_slot_start = working_slots[-1]
            last_hour_exit = last_slot_start + 0.5 # ← Corrección aplicada aquí
    
            # Buscar descanso
            rest_start = None
            rest_end = None
            for i in range(1, len(working_slots)):
                if working_slots[i] - working_slots[i-1] > 0.5:
                    rest_start = working_slots[i-1] + 0.5
                    rest_end = working_slots[i]
                    break
    
            horas_trabajadas = len(working_slots) * 0.5
            tiempo_descanso = (rest_end - rest_start) if rest_start and rest_end else 0
    
            fila = [
                store_sup,
                sup_name,
                day,
                time_to_hhmm(first_hour),
                time_to_hhmm(rest_start) if rest_start else "",
                time_to_hhmm(rest_end) if rest_end else "",
                time_to_hhmm(last_hour_exit), # ← Corrección aplicada aquí
                round(horas_trabajadas, 1),
                round(tiempo_descanso, 1) if tiempo_descanso > 0 else ""
            ]
    
            ws_detail.append(fila)
    # Auto-ajustar ancho de columnas
    column_widths = [10, 18, 8, 14, 18, 22, 18, 18, 20]
    for col, width in enumerate(column_widths, 1):
        col_letter = chr(64 + col) if col <= 26 else chr(64 + (col-26)//26) + chr(64 + (col-1)%26 + 1)
        ws_detail.column_dimensions[col_letter].width = width
    print("Hoja 'Reporte Turnos Detallado' creada exitosamente.")
    # Guardar archivo
    stores_suffix = "-".join(STORES)
    output_file = f"horarios_optimizados-{stores_suffix}-push_gap_{current_push_gap:.2f}.xlsx"
    wb.save(output_file)
    return True, output_file
    print(f"Archivo '{output_file}' generado exitosamente.")
    print("\n¡Optimización completada!")

if __name__ == "__main__":
    for item in STORES_TO_OPTIMIZE:
        
        if isinstance(item, list):
            stores_to_run = item
            has_supernumerary = True
            item_str = ", ".join(item)
        else:
            stores_to_run = [item]
            has_supernumerary = False
            item_str = item

        print(f"\n{'='*80}")
        print(f"--- INICIANDO OPTIMIZACIÓN PARA: {item_str} ---")
        
        # --- Generar diccionarios dinámicamente ---
        HOURS_PER_STORE_DAY, UNIFIED_HOURS_PER_DAY = generate_hour_slots(stores_to_run)
        COSTS_REGULAR, COSTS_OVERTIME = generate_cost_dictionaries(UNIFIED_HOURS_PER_DAY)
        print("--- Diccionarios de horarios y costos generados ---")
        print(f"{ '='*80}\n")

        current_push_gap = 0.8
        solution_found = False
        
        while current_push_gap >= 0:
            print(f"\n>>> Intentando resolver con push_gap = {current_push_gap:.2f}\n")
            is_feasible, result_file = run_optimization(
                    stores_to_run, has_supernumerary, current_push_gap,
                    HOURS_PER_STORE_DAY, UNIFIED_HOURS_PER_DAY,
                    COSTS_REGULAR, COSTS_OVERTIME)
            try:
                is_feasible, result_file = run_optimization(
                    stores_to_run, has_supernumerary, current_push_gap,
                    HOURS_PER_STORE_DAY, UNIFIED_HOURS_PER_DAY,
                    COSTS_REGULAR, COSTS_OVERTIME
                )
                
                if is_feasible:
                    print(f"\nSOLUCIÓN ENCONTRADA para {item_str} con push_gap = {current_push_gap:.2f}")
                    print(f"Resultado guardado en: {result_file}")
                    solution_found = True
                    break
                else:
                    print(f"Solución no factible con push_gap = {current_push_gap:.2f}. Reduciendo...")
                    current_push_gap -= 0.05
            
            except FileNotFoundError as e:
                print(f"ERROR FATAL: No se encontró el archivo de datos para {item_str}: {e}")
                PENDING_STORES.append(item)
                break
            except Exception as e:
                print(f"ERROR INESPERADO en {item_str} con push_gap {current_push_gap:.2f}: {e}")
                PENDING_STORES.append(item)
                break

        if not solution_found:
            print(f"\nNo se encontró solución para {item_str} en ningún intento.")
            # La tienda ya se agregó a pendientes dentro del bloque try/except si falló
            if item not in PENDING_STORES:
                 PENDING_STORES.append(item)

    # --- Guardado de tiendas pendientes ---
    if PENDING_STORES:
        print(f"\n{'='*80}")
        print("--- Guardando tiendas pendientes ---")
        
        formatted_pending = []
        for p_item in PENDING_STORES:
            if isinstance(p_item, list):
                formatted_pending.append(", ".join(p_item))
            else:
                formatted_pending.append(p_item)
                
        df_pending = pd.DataFrame(formatted_pending, columns=['tiendas_pendientes'])
        df_pending.to_excel("PENDING_STORES.xlsx", index=False)
        print("Archivo 'PENDING_STORES.xlsx' creado.")
    else:
        print(f"\n{'='*80}")
        print("\nTodas las optimizaciones se completaron.")

# ==============================================================================
# FIN DE LAS INSTRUCCIONES
# ==============================================================================
